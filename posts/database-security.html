<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®åº“å®‰å…¨åŠ å›º:ä»æƒé™æ§åˆ¶åˆ°å¤‡ä»½æ¢å¤ | ä½•å“¥çš„åšå®¢</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans SC", sans-serif;
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        body.light {
            background-color: #f8fafc;
            color: #1f2937;
        }

        body.dark {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        /* å¯¼èˆªæ  */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        body.light .navbar {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        body.dark .navbar {
            background: rgba(15, 23, 42, 0.95);
            border-bottom: 1px solid #1e293b;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #10b981, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
            list-style: none;
        }

        .nav-menu a {
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 8px 16px;
            border-radius: 8px;
        }

        body.light .nav-menu a {
            color: #4b5563;
        }

        body.dark .nav-menu a {
            color: #cbd5e1;
        }

        body.light .nav-menu a:hover {
            color: #10b981;
            background: #f3f4f6;
        }

        body.dark .nav-menu a:hover {
            color: #34d399;
            background: #1e293b;
        }

        .theme-toggle {
            width: 50px;
            height: 26px;
            border-radius: 13px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
        }

        body.light .theme-toggle {
            background: #e5e7eb;
        }

        body.dark .theme-toggle {
            background: #10b981;
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            background: white;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        body.dark .theme-toggle::before {
            transform: translateX(24px);
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            max-width: 900px;
            margin: 100px auto 60px;
            padding: 0 20px;
        }

        /* è¿”å›æŒ‰é’® */
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        /* æ–‡ç« å¤´éƒ¨ */
        .article-header {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid;
        }

        body.light .article-header {
            border-color: #e5e7eb;
        }

        body.dark .article-header {
            border-color: #334155;
        }

        .article-title {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        body.light .article-title {
            color: #1f2937;
        }

        body.dark .article-title {
            color: #f1f5f9;
        }

        .article-meta {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 14px;
        }

        body.light .article-meta {
            color: #6b7280;
        }

        body.dark .article-meta {
            color: #94a3b8;
        }

        .article-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .category-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 13px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .article-intro {
            font-size: 16px;
            line-height: 1.8;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 40px;
        }

        body.light .article-intro {
            background: #f8fafc;
            color: #475569;
        }

        body.dark .article-intro {
            background: #1e293b;
            color: #cbd5e1;
        }

        /* ç›®å½• */
        .toc {
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 40px;
            border-left: 4px solid #10b981;
        }

        body.light .toc {
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        body.dark .toc {
            background: #1e293b;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .toc h4 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        body.light .toc h4 {
            color: #1f2937;
        }

        body.dark .toc h4 {
            color: #f1f5f9;
        }

        .toc ul {
            list-style: none;
            display: grid;
            gap: 10px;
        }

        .toc li a {
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s;
            display: block;
        }

        body.light .toc li a {
            color: #4b5563;
        }

        body.dark .toc li a {
            color: #cbd5e1;
        }

        body.light .toc li a:hover {
            color: #10b981;
            background: #f3f4f6;
            transform: translateX(4px);
        }

        body.dark .toc li a:hover {
            color: #34d399;
            background: #0f172a;
            transform: translateX(4px);
        }

        /* ç›®å½•æ¿€æ´»çŠ¶æ€ */
        .toc li a.active {
            color: #10b981;
            background: rgba(16, 185, 129, 0.1);
            font-weight: 600;
            transform: translateX(8px);
        }

        body.dark .toc li a.active {
            color: #34d399;
            background: rgba(52, 211, 153, 0.1);
        }

        /* å†…å®¹åŒºå— */
        .content-section {
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s;
        }

        body.light .content-section {
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        body.dark .content-section {
            background: #1e293b;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .content-section:hover {
            transform: translateY(-2px);
        }

        body.light .content-section:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark .content-section:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        }

        h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid;
        }

        body.light h2 {
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
        }

        body.dark h2 {
            color: #34d399;
            border-color: rgba(52, 211, 153, 0.2);
        }

        h3 {
            font-size: 20px;
            font-weight: 600;
            margin: 24px 0 16px;
        }

        body.light h3 {
            color: #1f2937;
        }

        body.dark h3 {
            color: #f1f5f9;
        }

        p {
            margin-bottom: 16px;
            font-size: 15px;
            line-height: 1.8;
        }

        ul, ol {
            margin: 16px 0 16px 24px;
            line-height: 1.8;
        }

        li {
            margin-bottom: 10px;
            font-size: 15px;
        }

        strong {
            font-weight: 600;
        }

        body.light strong {
            color: #1f2937;
        }

        body.dark strong {
            color: #f1f5f9;
        }

        /* ä»£ç å— */
        .code-container {
            position: relative;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        pre {
            padding: 24px;
            overflow-x: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            border-left: 4px solid #10b981;
        }

        body.light pre {
            background: #f1f5f9;
        }

        body.dark pre {
            background: #0f172a;
        }

        code {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            padding: 2px 6px;
            border-radius: 4px;
        }

        body.light code {
            color: #dc2626;
            background: #f1f5f9;
        }

        body.dark code {
            color: #f87171;
            background: #1e293b;
        }

        /* ä»£ç è¯­æ³•é«˜äº® */
        .keyword { color: #10b981; font-weight: bold; }
        .string { color: #3b82f6; }
        .constant { color: #8b5cf6; }
        .comment { color: #6b7280; font-style: italic; }

        body.dark .keyword { color: #34d399; }
        body.dark .string { color: #60a5fa; }
        body.dark .constant { color: #a78bfa; }
        body.dark .comment { color: #94a3b8; }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 8px 16px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #059669;
        }

        .copy-btn.copied {
            background: #3b82f6;
        }

        /* ä¿¡æ¯æç¤º */
        .info-tip {
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        body.light .info-tip {
            background: rgba(59, 130, 246, 0.1);
        }

        body.dark .info-tip {
            background: rgba(59, 130, 246, 0.15);
        }

        .info-tip strong {
            color: #3b82f6;
            display: block;
            margin-bottom: 8px;
        }

        /* è­¦å‘Šæç¤º */
        .warning-tip {
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
        }

        body.light .warning-tip {
            background: rgba(245, 158, 11, 0.1);
        }

        body.dark .warning-tip {
            background: rgba(245, 158, 11, 0.15);
        }

        .warning-tip strong {
            color: #f59e0b;
            display: block;
            margin-bottom: 8px;
        }

        /* æˆåŠŸæç¤º */
        .success-tip {
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #10b981;
        }

        body.light .success-tip {
            background: rgba(16, 185, 129, 0.1);
        }

        body.dark .success-tip {
            background: rgba(16, 185, 129, 0.15);
        }

        .success-tip strong {
            color: #10b981;
            display: block;
            margin-bottom: 8px;
        }

        /* å±é™©æç¤º */
        .danger-tip {
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #ef4444;
        }

        body.light .danger-tip {
            background: rgba(239, 68, 68, 0.1);
        }

        body.dark .danger-tip {
            background: rgba(239, 68, 68, 0.15);
        }

        .danger-tip strong {
            color: #ef4444;
            display: block;
            margin-bottom: 8px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .security-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .security-table th, .security-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid;
        }

        body.light .security-table th {
            background: #f1f5f9;
            color: #1f2937;
            border-color: #e5e7eb;
        }

        body.dark .security-table th {
            background: #0f172a;
            color: #f1f5f9;
            border-color: #334155;
        }

        body.light .security-table td {
            border-color: #e5e7eb;
        }

        body.dark .security-table td {
            border-color: #334155;
        }

        /* ç‰¹æ€§å¡ç‰‡ */
        .security-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .security-card {
            padding: 20px;
            border-radius: 12px;
            transition: all 0.3s;
        }

        body.light .security-card {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
        }

        body.dark .security-card {
            background: #0f172a;
            border: 1px solid #334155;
        }

        .security-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        body.dark .security-card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .security-card h4 {
            font-size: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #10b981;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .article-title {
                font-size: 28px;
            }

            .content-section {
                padding: 20px;
            }

            pre {
                padding: 16px;
                font-size: 13px;
            }

            .copy-btn {
                padding: 6px 12px;
                font-size: 12px;
            }

            .security-table th, .security-table td {
                padding: 8px 10px;
                font-size: 14px;
            }

            .security-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 0 16px;
            }

            .toc {
                padding: 16px;
            }

            .article-title {
                font-size: 24px;
            }

            h2 {
                font-size: 20px;
            }

            h3 {
                font-size: 18px;
            }

            .security-table {
                font-size: 13px;
            }
        }

        /* å›åˆ°é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #10b981;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            transition: all 0.3s;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        /* å®‰å…¨å±‚çº§å›¾ç¤º */
        .security-levels {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
            padding: 20px;
            border-radius: 12px;
        }

        body.light .security-levels {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
        }

        body.dark .security-levels {
            background: #1e293b;
            border: 1px solid #334155;
        }

        .security-level {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .security-level:hover {
            transform: translateX(5px);
        }

        .level-number {
            width: 36px;
            height: 36px;
            background: #10b981;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .level-content {
            flex-grow: 1;
        }

        .level-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #10b981;
        }

        body.dark .level-title {
            color: #34d399;
        }

        /* æ•°æ®åº“å¤‡ä»½æµç¨‹å›¾ */
        .backup-flow {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
            padding: 20px;
            border-radius: 12px;
        }

        body.light .backup-flow {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
        }

        body.dark .backup-flow {
            background: #1e293b;
            border: 1px solid #334155;
        }

        .flow-step {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-radius: 8px;
            background: white;
        }

        body.dark .flow-step {
            background: #0f172a;
        }

        .flow-step-number {
            width: 28px;
            height: 28px;
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .flow-step-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .flow-icon {
            font-size: 18px;
        }

        /* æƒé™çŸ©é˜µ */
        .permission-matrix {
            overflow-x: auto;
            margin: 25px 0;
        }

        .permission-table {
            min-width: 700px;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
        }

        .permission-table th {
            background: #10b981;
            color: white;
            font-weight: 600;
            padding: 14px 16px;
            text-align: center;
        }

        .permission-table td {
            padding: 12px 16px;
            border-bottom: 1px solid;
        }

        body.light .permission-table td {
            border-color: #e5e7eb;
        }

        body.dark .permission-table td {
            border-color: #334155;
        }

        .permission-yes {
            color: #10b981;
            font-weight: bold;
            text-align: center;
        }

        .permission-no {
            color: #ef4444;
            text-align: center;
        }

        .permission-partial {
            color: #f59e0b;
            text-align: center;
        }
    </style>
</head>
<body class="dark">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">ä½•å“¥çš„åšå®¢</a>
            <ul class="nav-menu">
                <li><a href="../index.html">é¦–é¡µ</a></li>
                <li><a href="../index.html#projects">é¡¹ç›®æ¡ˆä¾‹</a></li>
                <li><a href="../index.html#experience">å·¥ä½œç»å†</a></li>
                <li><a href="../pages/articles.html">æŠ€æœ¯æ–‡ç« </a></li>
                <li><a href="../pages/about.html">å…³äºæˆ‘</a></li>
            </ul>
            <div class="theme-toggle" onclick="toggleTheme()"></div>
        </div>
    </nav>

    <main class="main-content">
        <!-- è¿”å›æŒ‰é’® -->
        <a href="../pages/articles.html" class="back-button">
            <i class="fas fa-arrow-left"></i>
            <span>è¿”å›æ–‡ç« åˆ—è¡¨</span>
        </a>

        <!-- æ–‡ç« å¤´éƒ¨ -->
        <div class="article-header">
            <h1 class="article-title">æ•°æ®åº“å®‰å…¨åŠ å›º:ä»æƒé™æ§åˆ¶åˆ°å¤‡ä»½æ¢å¤</h1>
            <div class="article-meta">
                <span class="category-badge">æ•°æ®åº“å®‰å…¨</span>
                <span><i class="far fa-calendar"></i> 2025-12-10</span>
                <span><i class="far fa-clock"></i> é˜…è¯» 10 åˆ†é’Ÿ</span>
                <span><i class="far fa-eye"></i> 1568 æ¬¡æµè§ˆ</span>
            </div>
        </div>

        <!-- æ–‡ç« ç®€ä»‹ -->
        <div class="article-intro">
            å…¨é¢è®²è§£æ•°æ®åº“å®‰å…¨çš„å„ä¸ªç¯èŠ‚ï¼ŒåŒ…æ‹¬è®¿é—®æ§åˆ¶ã€SQLæ³¨å…¥é˜²æŠ¤ã€æ•°æ®åŠ å¯†ã€å®šæœŸå¤‡ä»½ç­‰ä¼ä¸šçº§æ–¹æ¡ˆã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨æ•°æ®åº“å®‰å…¨çš„æ ¸å¿ƒè¦ç´ ï¼Œæä¾›ä»åŸºç¡€åˆ°é«˜çº§çš„å…¨é¢é˜²æŠ¤ç­–ç•¥ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºåšå›ºçš„æ•°æ®å®‰å…¨é˜²çº¿ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²ã€ç¯¡æ”¹å’Œä¸¢å¤±ã€‚
        </div>

        <!-- ç›®å½• -->
        <div class="toc">
            <h4>ğŸ“‹ æ–‡ç« ç›®å½•</h4>
            <ul>
                <li><a href="#overview">ä¸€ã€æ•°æ®åº“å®‰å…¨æ¦‚è¿°ä¸é‡è¦æ€§</a></li>
                <li><a href="#access-control">äºŒã€è®¿é—®æ§åˆ¶ä¸æƒé™ç®¡ç†</a></li>
                <li><a href="#sql-injection">ä¸‰ã€SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥</a></li>
                <li><a href="#encryption">å››ã€æ•°æ®åŠ å¯†æŠ€æœ¯åº”ç”¨</a></li>
                <li><a href="#backup">äº”ã€å®šæœŸå¤‡ä»½ä¸æ¢å¤ç­–ç•¥</a></li>
                <li><a href="#monitoring">å…­ã€ç›‘æ§ä¸å®¡è®¡æœºåˆ¶</a></li>
                <li><a href="#enterprise">ä¸ƒã€ä¼ä¸šçº§æ•°æ®åº“å®‰å…¨æ¶æ„</a></li>
                <li><a href="#summary">å…«ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</a></li>
            </ul>
        </div>

        <!-- æ•°æ®åº“å®‰å…¨æ¦‚è¿°ä¸é‡è¦æ€§ -->
        <section class="content-section" id="overview">
            <h2>ä¸€ã€æ•°æ®åº“å®‰å…¨æ¦‚è¿°ä¸é‡è¦æ€§</h2>
            
            <h3>1. æ•°æ®åº“å®‰å…¨é¢ä¸´çš„æŒ‘æˆ˜</h3>
            <p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼Œæ•°æ®åº“ä½œä¸ºä¼ä¸šæ ¸å¿ƒèµ„äº§çš„å­˜å‚¨ä¸­å¿ƒï¼Œé¢ä¸´ç€æ¥è‡ªå†…å¤–éƒ¨çš„å¤šé‡å®‰å…¨å¨èƒï¼š</p>
            
            <div class="security-cards">
                <div class="security-card">
                    <h4><i class="fas fa-user-secret"></i> å†…éƒ¨å¨èƒ</h4>
                    <p>å‘˜å·¥è¯¯æ“ä½œã€æ¶æ„è¡Œä¸ºæˆ–æƒé™æ»¥ç”¨å¯¼è‡´çš„æ•°æ®æ³„éœ²å’Œç ´åã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-globe"></i> å¤–éƒ¨æ”»å‡»</h4>
                    <p>SQLæ³¨å…¥ã€æš´åŠ›ç ´è§£ã€DDoSæ”»å‡»ç­‰å¤–éƒ¨æ¶æ„è¡Œä¸ºã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-exclamation-triangle"></i> åˆè§„é£é™©</h4>
                    <p>è¿åGDPRã€ç½‘ç»œå®‰å…¨æ³•ç­‰æ³•å¾‹æ³•è§„å¸¦æ¥çš„æ³•å¾‹é£é™©ã€‚</p>
                </div>
            </div>

            <div class="danger-tip">
                <strong>ğŸš¨ æ•°æ®æ³„éœ²çš„ä»£ä»·ï¼š</strong>
                <p>æ ¹æ®IBMã€Š2025å¹´æ•°æ®æ³„éœ²æˆæœ¬æŠ¥å‘Šã€‹ï¼Œå¹³å‡æ•°æ®æ³„éœ²æˆæœ¬è¾¾åˆ°435ä¸‡ç¾å…ƒï¼Œæ¯”ä¸Šä¸€å¹´å¢é•¿2.6%ã€‚å…¶ä¸­åŒ»ç–—è¡Œä¸šæ•°æ®æ³„éœ²æˆæœ¬æœ€é«˜ï¼Œå¹³å‡è¾¾åˆ°1010ä¸‡ç¾å…ƒã€‚</p>
            </div>

            <h3>2. æ•°æ®åº“å®‰å…¨é˜²æŠ¤å±‚çº§</h3>
            <p>å…¨é¢çš„æ•°æ®åº“å®‰å…¨é˜²æŠ¤éœ€è¦è¦†ç›–å¤šä¸ªå±‚çº§ï¼š</p>
            
            <div class="security-levels">
                <div class="security-level">
                    <div class="level-number">1</div>
                    <div class="level-content">
                        <div class="level-title">ç½‘ç»œå±‚é˜²æŠ¤</div>
                        <p>é˜²ç«å¢™é…ç½®ã€ç½‘ç»œéš”ç¦»ã€VPNè®¿é—®æ§åˆ¶ã€ç«¯å£å®‰å…¨</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">2</div>
                    <div class="level-content">
                        <div class="level-title">è®¿é—®æ§åˆ¶å±‚</div>
                        <p>èº«ä»½è®¤è¯ã€æƒé™ç®¡ç†ã€æœ€å°æƒé™åŸåˆ™ã€è§’è‰²åˆ†ç¦»</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">3</div>
                    <div class="level-content">
                        <div class="level-title">æ•°æ®å±‚é˜²æŠ¤</div>
                        <p>æ•°æ®åŠ å¯†ã€è„±æ•å¤„ç†ã€æ•°æ®åˆ†ç±»ã€è®¿é—®å®¡è®¡</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">4</div>
                    <div class="level-content">
                        <div class="level-title">åº”ç”¨å±‚é˜²æŠ¤</div>
                        <p>è¾“å…¥éªŒè¯ã€å‚æ•°åŒ–æŸ¥è¯¢ã€å­˜å‚¨è¿‡ç¨‹ã€ORMæ¡†æ¶å®‰å…¨</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">5</div>
                    <div class="level-content">
                        <div class="level-title">è¿ç»´å±‚é˜²æŠ¤</div>
                        <p>å®šæœŸå¤‡ä»½ã€æ¼æ´æ‰«æã€å®‰å…¨è¡¥ä¸ã€ç›‘æ§å‘Šè­¦</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- è®¿é—®æ§åˆ¶ä¸æƒé™ç®¡ç† -->
        <section class="content-section" id="access-control">
            <h2>äºŒã€è®¿é—®æ§åˆ¶ä¸æƒé™ç®¡ç†</h2>
            
            <div class="info-tip">
                <strong>ğŸ” æœ€å°æƒé™åŸåˆ™ï¼š</strong>
                <p>æ¯ä¸ªç”¨æˆ·å’Œè¿›ç¨‹åªèƒ½æ‹¥æœ‰å®Œæˆå…¶ä»»åŠ¡æ‰€å¿…éœ€çš„æœ€å°æƒé™ã€‚è¿™æ˜¯æ•°æ®åº“å®‰å…¨çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸€ã€‚</p>
            </div>

            <h3>1. ç”¨æˆ·ä¸è§’è‰²ç®¡ç†</h3>
            <p>åˆç†çš„ç”¨æˆ·è§’è‰²åˆ’åˆ†æ˜¯æƒé™ç®¡ç†çš„åŸºç¡€ï¼š</p>
            
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶SQL</button>
                <pre><code>-- MySQL ç”¨æˆ·ä¸è§’è‰²ç®¡ç†ç¤ºä¾‹
-- 1. åˆ›å»ºä¸åŒè§’è‰²çš„ç”¨æˆ·
CREATE USER 'app_readonly'@'%' IDENTIFIED BY 'StrongPassword123!';
CREATE USER 'app_write'@'192.168.1.%' IDENTIFIED BY 'StrongPassword456!';
CREATE USER 'admin'@'localhost' IDENTIFIED BY 'AdminStrongPass789!';

-- 2. åˆ›å»ºè§’è‰²
CREATE ROLE 'readonly_role', 'write_role', 'admin_role';

-- 3. ä¸ºè§’è‰²åˆ†é…æƒé™
-- åªè¯»è§’è‰²ï¼šåªèƒ½æŸ¥è¯¢ç‰¹å®šæ•°æ®åº“
GRANT SELECT ON company_db.* TO 'readonly_role';

-- è¯»å†™è§’è‰²ï¼šå¯ä»¥æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°ç‰¹å®šè¡¨
GRANT SELECT, INSERT, UPDATE ON company_db.customers TO 'write_role';
GRANT SELECT, INSERT, UPDATE ON company_db.orders TO 'write_role';

-- ç®¡ç†å‘˜è§’è‰²ï¼šå®Œæ•´æƒé™ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
GRANT ALL PRIVILEGES ON company_db.* TO 'admin_role' WITH GRANT OPTION;

-- 4. å°†è§’è‰²åˆ†é…ç»™ç”¨æˆ·
GRANT 'readonly_role' TO 'app_readonly'@'%';
GRANT 'write_role' TO 'app_write'@'192.168.1.%';
GRANT 'admin_role' TO 'admin'@'localhost';

-- 5. è®¾ç½®é»˜è®¤è§’è‰²
SET DEFAULT ROLE 'readonly_role' FOR 'app_readonly'@'%';
SET DEFAULT ROLE 'write_role' FOR 'app_write'@'192.168.1.%';
SET DEFAULT ROLE 'admin_role' FOR 'admin'@'localhost';

-- 6. æŸ¥çœ‹ç”¨æˆ·æƒé™
SHOW GRANTS FOR 'app_readonly'@'%';
SHOW GRANTS FOR 'app_write'@'192.168.1.%';

-- 7. å®šæœŸå®¡è®¡ç”¨æˆ·æƒé™
SELECT * FROM mysql.user WHERE User NOT IN ('mysql.sys', 'mysql.session', 'mysql.infoschema');
SELECT User, Host, authentication_string FROM mysql.user WHERE authentication_string = ''; -- æŸ¥æ‰¾ç©ºå¯†ç ç”¨æˆ·</code></pre>
            </div>

            <h3>2. æƒé™çŸ©é˜µè®¾è®¡</h3>
            <p>ä¼ä¸šçº§æ•°æ®åº“æƒé™çŸ©é˜µç¤ºä¾‹ï¼š</p>
            
            <div class="permission-matrix">
                <table class="permission-table">
                    <thead>
                        <tr>
                            <th>æ“ä½œ/è§’è‰²</th>
                            <th>åªè¯»ç”¨æˆ·</th>
                            <th>æ•°æ®å½•å…¥å‘˜</th>
                            <th>æ•°æ®åˆ†æå¸ˆ</th>
                            <th>å¼€å‘äººå‘˜</th>
                            <th>DBA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>SELECTï¼ˆæŸ¥è¯¢ï¼‰</strong></td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>INSERTï¼ˆæ’å…¥ï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>UPDATEï¼ˆæ›´æ–°ï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-partial">éƒ¨åˆ†</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>DELETEï¼ˆåˆ é™¤ï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-partial">æµ‹è¯•ç¯å¢ƒ</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>CREATEï¼ˆåˆ›å»ºè¡¨ï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>DROPï¼ˆåˆ é™¤è¡¨ï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                        <tr>
                            <td><strong>GRANTï¼ˆæˆæƒï¼‰</strong></td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-no">âœ—</td>
                            <td class="permission-yes">âœ“</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>3. æœ€ä½³å®è·µï¼šå®šæœŸæƒé™å®¡è®¡</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶è„šæœ¬</button>
                <pre><code>#!/bin/bash
# database_permission_audit.sh
# æ•°æ®åº“æƒé™å®¡è®¡è„šæœ¬

DB_HOST="localhost"
DB_PORT="3306"
DB_USER="audit_user"
DB_PASS="AuditPass123!"
AUDIT_REPORT="/var/log/db_audit/report_$(date +%Y%m%d).txt"

# åˆ›å»ºå®¡è®¡ç›®å½•
mkdir -p /var/log/db_audit

echo "=== æ•°æ®åº“æƒé™å®¡è®¡æŠ¥å‘Š ===" > $AUDIT_REPORT
echo "å®¡è®¡æ—¶é—´: $(date)" >> $AUDIT_REPORT
echo "æ•°æ®åº“ä¸»æœº: $DB_HOST" >> $AUDIT_REPORT
echo "==========================" >> $AUDIT_REPORT

# 1. æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·åŠå…¶æƒé™
echo -e "\n1. æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·åŠæƒé™:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT 
    User, 
    Host,
    Grant_priv,
    Alter_priv,
    Create_priv,
    Delete_priv,
    Drop_priv,
    Insert_priv,
    Select_priv,
    Update_priv
FROM mysql.user 
WHERE User NOT IN ('mysql.sys', 'mysql.session', 'mysql.infoschema')
ORDER BY User, Host;
" >> $AUDIT_REPORT

# 2. æ£€æŸ¥ç©ºå¯†ç ç”¨æˆ·
echo -e "\n2. ç©ºå¯†ç ç”¨æˆ·æ£€æŸ¥:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT User, Host 
FROM mysql.user 
WHERE authentication_string = '' OR authentication_string IS NULL;
" >> $AUDIT_REPORT

# 3. æ£€æŸ¥å¼±å¯†ç ç”¨æˆ·ï¼ˆç¤ºä¾‹æ£€æŸ¥ï¼‰
echo -e "\n3. å¯èƒ½ä½¿ç”¨å¼±å¯†ç çš„ç”¨æˆ·:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT User, Host 
FROM mysql.user 
WHERE User IN ('root', 'admin', 'test', 'user', 'guest');
" >> $AUDIT_REPORT

# 4. æ£€æŸ¥æ•°æ®åº“çº§åˆ«çš„æƒé™
echo -e "\n4. æ•°æ®åº“çº§åˆ«æƒé™:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT 
    User, 
    Host, 
    Db, 
    Select_priv,
    Insert_priv,
    Update_priv,
    Delete_priv,
    Create_priv,
    Drop_priv
FROM mysql.db 
ORDER BY User, Db;
" >> $AUDIT_REPORT

# 5. æ£€æŸ¥è¡¨çº§åˆ«æƒé™
echo -e "\n5. è¡¨çº§åˆ«æƒé™:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT 
    User, 
    Host, 
    Db, 
    Table_name,
    Table_priv
FROM mysql.tables_priv 
ORDER BY User, Db, Table_name;
" >> $AUDIT_REPORT

# 6. æ£€æŸ¥æœ€è¿‘ä¿®æ”¹çš„æƒé™
echo -e "\n6. æœ€è¿‘7å¤©æƒé™å˜æ›´è®°å½•:" >> $AUDIT_REPORT
mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "
SELECT * FROM mysql.general_log 
WHERE argument_text LIKE '%GRANT%' 
   OR argument_text LIKE '%REVOKE%'
   AND event_time > DATE_SUB(NOW(), INTERVAL 7 DAY)
ORDER BY event_time DESC
LIMIT 20;
" >> $AUDIT_REPORT

echo -e "\n=== å®¡è®¡å®Œæˆ ===" >> $AUDIT_REPORT
echo "æŠ¥å‘Šå·²ä¿å­˜è‡³: $AUDIT_REPORT"

# å‘é€å®¡è®¡æŠ¥å‘Šï¼ˆå¯é€‰ï¼‰
# mail -s "æ•°æ®åº“æƒé™å®¡è®¡æŠ¥å‘Š" admin@example.com < $AUDIT_REPORT</code></pre>
            </div>
        </section>

        <!-- SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥ -->
        <section class="content-section" id="sql-injection">
            <h2>ä¸‰ã€SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥</h2>
            
            <div class="danger-tip">
                <strong>ğŸ’‰ SQLæ³¨å…¥å¨èƒï¼š</strong>
                <p>OWASP Top 10 2023ä¸­ï¼Œæ³¨å…¥æ”»å‡»ï¼ˆåŒ…æ‹¬SQLæ³¨å…¥ï¼‰ä»ç„¶ä½åˆ—å‰ä¸‰ã€‚æ”»å‡»è€…é€šè¿‡æ³¨å…¥æ¶æ„SQLä»£ç ï¼Œå¯ä»¥çªƒå–ã€ç¯¡æ”¹æˆ–ç ´åæ•°æ®åº“æ•°æ®ã€‚</p>
            </div>

            <h3>1. SQLæ³¨å…¥æ”»å‡»ç¤ºä¾‹</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">æŸ¥çœ‹ç¤ºä¾‹</button>
                <pre><code>-- æ˜“å—SQLæ³¨å…¥æ”»å‡»çš„ä»£ç ï¼ˆPythonç¤ºä¾‹ï¼‰
import mysql.connector

def unsafe_login(username, password):
    """ä¸å®‰å…¨çš„ç™»å½•éªŒè¯æ–¹å¼"""
    conn = mysql.connector.connect(host="localhost", database="app_db", user="app_user")
    cursor = conn.cursor()
    
    # å±é™©ï¼šç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥åˆ°SQLè¯­å¥ä¸­
    query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"
    
    cursor.execute(query)
    result = cursor.fetchone()
    
    cursor.close()
    conn.close()
    return result

# æ”»å‡»è€…è¾“å…¥ç¤ºä¾‹ï¼š
# username: admin' --
# password: anything
# ç”Ÿæˆçš„SQL: SELECT * FROM users WHERE username = 'admin' --' AND password = 'anything'
# æ³¨é‡Šç¬¦(--)ä½¿å¯†ç æ£€æŸ¥å¤±æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥ä»¥adminèº«ä»½ç™»å½•

# æ›´å±é™©çš„æ”»å‡»ï¼š
# username: admin' OR '1'='1
# password: ' OR '1'='1
# ç”Ÿæˆçš„SQL: SELECT * FROM users WHERE username = 'admin' OR '1'='1' AND password = '' OR '1'='1'
# è¿™å°†è¿”å›æ‰€æœ‰ç”¨æˆ·è®°å½•</code></pre>
            </div>

            <h3>2. é˜²æŠ¤æªæ–½ï¼šå‚æ•°åŒ–æŸ¥è¯¢</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶ä»£ç </button>
                <pre><code># å®‰å…¨çš„å‚æ•°åŒ–æŸ¥è¯¢ç¤ºä¾‹ï¼ˆPythonï¼‰
import mysql.connector

def safe_login(username, password):
    """ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢çš„å®‰å…¨ç™»å½•éªŒè¯"""
    conn = mysql.connector.connect(host="localhost", database="app_db", user="app_user")
    cursor = conn.cursor(prepared=True)  # å¯ç”¨é¢„å¤„ç†è¯­å¥
    
    # å®‰å…¨ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
    query = "SELECT * FROM users WHERE username = %s AND password = %s"
    
    # å‚æ•°ä¼šè¢«è‡ªåŠ¨è½¬ä¹‰ï¼Œé˜²æ­¢SQLæ³¨å…¥
    cursor.execute(query, (username, password))
    result = cursor.fetchone()
    
    cursor.close()
    conn.close()
    return result

# å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„å‚æ•°åŒ–æŸ¥è¯¢ç¤ºä¾‹ï¼š

# PHP (PDO)
# $stmt = $pdo->prepare("SELECT * FROM users WHERE username = :username AND password = :password");
# $stmt->execute(['username' => $username, 'password' => $password]);

# Java (JDBC)
# String query = "SELECT * FROM users WHERE username = ? AND password = ?";
# PreparedStatement stmt = conn.prepareStatement(query);
# stmt.setString(1, username);
# stmt.setString(2, password);

# Node.js (mysql2)
# const [rows] = await connection.execute(
#     'SELECT * FROM users WHERE username = ? AND password = ?',
#     [username, password]
# );</code></pre>
            </div>

            <h3>3. è¾“å…¥éªŒè¯ä¸è¿‡æ»¤</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶ä»£ç </button>
                <pre><code>import re

def validate_input(input_string, input_type):
    """è¾“å…¥éªŒè¯å‡½æ•°"""
    
    validation_rules = {
        'username': {
            'pattern': r'^[a-zA-Z0-9_]{3,20}$',
            'message': 'ç”¨æˆ·åå¿…é¡»æ˜¯3-20ä½çš„å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿'
        },
        'email': {
            'pattern': r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$',
            'message': 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'
        },
        'phone': {
            'pattern': r'^1[3-9]\d{9}$',
            'message': 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·ç '
        },
        'integer': {
            'pattern': r'^\d+$',
            'message': 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ•´æ•°'
        },
        'float': {
            'pattern': r'^\d+(\.\d+)?$',
            'message': 'è¯·è¾“å…¥æœ‰æ•ˆçš„æµ®ç‚¹æ•°'
        }
    }
    
    if input_type not in validation_rules:
        raise ValueError(f"æœªçŸ¥çš„è¾“å…¥ç±»å‹: {input_type}")
    
    rule = validation_rules[input_type]
    
    if not re.match(rule['pattern'], input_string):
        raise ValueError(rule['message'])
    
    return True

def sanitize_sql_input(input_string):
    """SQLè¾“å…¥æ¸…ç†ï¼ˆé¢å¤–çš„å®‰å…¨å±‚ï¼‰"""
    # ç§»é™¤æˆ–è½¬ä¹‰å±é™©å­—ç¬¦
    dangerous_patterns = [
        (r'--', ''),           # SQLæ³¨é‡Š
        (r';', '\\;'),         # è¯­å¥åˆ†éš”ç¬¦
        (r"'", "\\'"),         # å•å¼•å·
        (r'"', '\\"'),         # åŒå¼•å·
        (r'/', '\\/'),         # æ–œæ 
        (r'\\', '\\\\'),       # åæ–œæ 
        (r'%', '\\%'),         # é€šé…ç¬¦
        (r'_', '\\_'),         # é€šé…ç¬¦
        (r'\(', '\\('),        # æ‹¬å·
        (r'\)', '\\)'),        # æ‹¬å·
        (r'union\s+select', 'union select'),  # é˜»æ­¢union select
        (r'select.*from', 'select from'),     # é˜»æ­¢select from
        (r'insert\s+into', 'insert into'),    # é˜»æ­¢insert into
        (r'drop\s+table', 'drop table'),      # é˜»æ­¢drop table
        (r'delete\s+from', 'delete from'),    # é˜»æ­¢delete from
        (r'update\s+set', 'update set'),      # é˜»æ­¢update set
    ]
    
    sanitized = input_string
    for pattern, replacement in dangerous_patterns:
        sanitized = re.sub(pattern, replacement, sanitized, flags=re.IGNORECASE)
    
    return sanitized

# ä½¿ç”¨ç¤ºä¾‹
try:
    username = "admin'; DROP TABLE users; --"
    
    # 1. éªŒè¯è¾“å…¥
    validate_input(username, 'username')  # è¿™ä¼šå¤±è´¥ï¼Œå› ä¸ºåŒ…å«éæ³•å­—ç¬¦
    
    # 2. æ¸…ç†è¾“å…¥ï¼ˆå³ä½¿éªŒè¯é€šè¿‡ä¹Ÿæ‰§è¡Œï¼‰
    safe_username = sanitize_sql_input(username)
    print(f"æ¸…ç†åçš„ç”¨æˆ·å: {safe_username}")
    
except ValueError as e:
    print(f"è¾“å…¥éªŒè¯å¤±è´¥: {e}")
    
# æ³¨æ„ï¼šè¾“å…¥æ¸…ç†ä¸èƒ½æ›¿ä»£å‚æ•°åŒ–æŸ¥è¯¢ï¼Œåº”ä½œä¸ºé¢å¤–çš„å®‰å…¨å±‚ä½¿ç”¨</code></pre>
            </div>

            <h3>4. Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰è§„åˆ™</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶é…ç½®</button>
                <pre><code># Nginx + ModSecurity WAFé…ç½®ç¤ºä¾‹
# é˜²æ­¢SQLæ³¨å…¥æ”»å‡»çš„è§„åˆ™

# 1. å¯ç”¨ModSecurity
load_module modules/ngx_http_modsecurity_module.so;

http {
    modsecurity on;
    modsecurity_rules_file /etc/nginx/modsec/main.conf;
    
    server {
        listen 80;
        server_name example.com;
        
        location / {
            # å¯ç”¨ModSecurity
            modsecurity on;
            
            # SQLæ³¨å…¥æ£€æµ‹è§„åˆ™
            modsecurity_rules '
                # æ£€æµ‹SQLæ³¨å…¥å…³é”®è¯
                SecRule ARGS|ARGS_NAMES|REQUEST_BODY|REQUEST_HEADERS 
                    "@rx (union\s+select|select\s+.*from|insert\s+into|drop\s+table|delete\s+from|update\s+set|create\s+table|alter\s+table|truncate\s+table)" 
                    "id:1001,phase:2,deny,status:403,msg:\'SQL Injection Attempt\',logdata:\'%{MATCHED_VAR}\'"
                
                # æ£€æµ‹SQLæ³¨é‡Šç¬¦
                SecRule ARGS|ARGS_NAMES|REQUEST_BODY|REQUEST_HEADERS 
                    "@rx (--|#|/\*|\*/)" 
                    "id:1002,phase:2,deny,status:403,msg:\'SQL Comment Detection\',logdata:\'%{MATCHED_VAR}\'"
                
                # æ£€æµ‹SQLè¯­å¥åˆ†éš”ç¬¦
                SecRule ARGS|ARGS_NAMES|REQUEST_BODY|REQUEST_HEADERS 
                    "@rx (;|\`)" 
                    "id:1003,phase:2,deny,status:403,msg:\'SQL Statement Delimiter\',logdata:\'%{MATCHED_VAR}\'"
                
                # æ£€æµ‹SQLå‡½æ•°è°ƒç”¨
                SecRule ARGS|ARGS_NAMES|REQUEST_BODY|REQUEST_HEADERS 
                    "@rx (database\(\)|version\(\)|user\(\)|sleep\(|benchmark\(|load_file\(|into\s+outfile|into\s+dumpfile)" 
                    "id:1004,phase:2,deny,status:403,msg:\'SQL Function Detection\',logdata:\'%{MATCHED_VAR}\'"
                
                # æ£€æµ‹SQLé”™è¯¯ä¿¡æ¯æ³„éœ²ï¼ˆé˜²æ­¢ä¿¡æ¯æ³„éœ²ï¼‰
                SecRule RESPONSE_BODY 
                    "@rx (SQL syntax|MySQL server version|You have an error in your SQL syntax|Unknown column|Table \'.*\' doesn\'t exist)" 
                    "id:1005,phase:4,deny,status:403,msg:\'SQL Error Information Leak\',logdata:\'%{MATCHED_VAR}\'"
                
                # é™åˆ¶è¯·æ±‚å‚æ•°é•¿åº¦ï¼ˆé˜²æ­¢è¿‡é•¿çš„æ³¨å…¥payloadï¼‰
                SecRule &ARGS "@gt 20" 
                    "id:1006,phase:1,deny,status:403,msg:\'Too many parameters\'"
                
                SecRule ARGS "@gt 1000" 
                    "id:1007,phase:1,deny,status:403,msg:\'Parameter value too long\'"
            ';
        }
    }
}</code></pre>
            </div>
        </section>

        <!-- æ•°æ®åŠ å¯†æŠ€æœ¯åº”ç”¨ -->
        <section class="content-section" id="encryption">
            <h2>å››ã€æ•°æ®åŠ å¯†æŠ€æœ¯åº”ç”¨</h2>
            
            <div class="info-tip">
                <strong>ğŸ”’ åŠ å¯†ç­–ç•¥ï¼š</strong>
                <p>æ ¹æ®æ•°æ®æ•æ„Ÿç¨‹åº¦é‡‡ç”¨ä¸åŒçš„åŠ å¯†ç­–ç•¥ï¼šä¼ è¾“åŠ å¯†ã€å­˜å‚¨åŠ å¯†ã€å­—æ®µçº§åŠ å¯†ã€å…¨ç›˜åŠ å¯†ç­‰ã€‚</p>
            </div>

            <h3>1. æ•°æ®ä¼ è¾“åŠ å¯†ï¼ˆSSL/TLSï¼‰</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶é…ç½®</button>
                <pre><code># MySQL SSL/TLS é…ç½®ç¤ºä¾‹

# 1. ç”ŸæˆSSLè¯ä¹¦å’Œå¯†é’¥
# ç”ŸæˆCAè¯ä¹¦
openssl genrsa 2048 > ca-key.pem
openssl req -new -x509 -nodes -days 3650 -key ca-key.pem -out ca-cert.pem

# ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦
openssl req -newkey rsa:2048 -days 3650 -nodes -keyout server-key.pem -out server-req.pem
openssl rsa -in server-key.pem -out server-key.pem
openssl x509 -req -in server-req.pem -days 3650 -CA ca-cert.pem -CAkey ca-key.pem -set_serial 01 -out server-cert.pem

# ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦
openssl req -newkey rsa:2048 -days 3650 -nodes -keyout client-key.pem -out client-req.pem
openssl rsa -in client-key.pem -out client-key.pem
openssl x509 -req -in client-req.pem -days 3650 -CA ca-cert.pem -CAkey ca-key.pem -set_serial 01 -out client-cert.pem

# 2. MySQLæœåŠ¡å™¨SSLé…ç½® (my.cnf)
[mysqld]
ssl-ca=/etc/mysql/ssl/ca-cert.pem
ssl-cert=/etc/mysql/ssl/server-cert.pem
ssl-key=/etc/mysql/ssl/server-key.pem

# è¦æ±‚æ‰€æœ‰è¿œç¨‹è¿æ¥ä½¿ç”¨SSL
require_secure_transport=ON

# 3. åˆ›å»ºè¦æ±‚SSLçš„ç”¨æˆ·
CREATE USER 'secure_user'@'%' IDENTIFIED BY 'StrongPassword123!' REQUIRE SSL;
GRANT ALL PRIVILEGES ON secure_db.* TO 'secure_user'@'%';

# 4. å®¢æˆ·ç«¯è¿æ¥ç¤ºä¾‹
mysql --ssl-ca=/path/to/ca-cert.pem \
      --ssl-cert=/path/to/client-cert.pem \
      --ssl-key=/path/to/client-key.pem \
      -h db.example.com -u secure_user -p

# 5. éªŒè¯SSLè¿æ¥çŠ¶æ€
SHOW VARIABLES LIKE '%ssl%';
SHOW STATUS LIKE 'Ssl_cipher';
SHOW STATUS LIKE 'Ssl_version';

# 6. æ£€æŸ¥å½“å‰è¿æ¥çš„SSLçŠ¶æ€
SELECT * FROM performance_schema.session_status 
WHERE VARIABLE_NAME IN ('Ssl_version', 'Ssl_cipher', 'Ssl_cipher_list');</code></pre>
            </div>

            <h3>2. æ•°æ®å­˜å‚¨åŠ å¯†</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶ä»£ç </button>
                <pre><code># Python æ•°æ®åŠ å¯†ç¤ºä¾‹
from cryptography.fernet import Fernet
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2
import base64
import os

class DatabaseEncryptor:
    """æ•°æ®åº“å­—æ®µçº§åŠ å¯†å·¥å…·ç±»"""
    
    def __init__(self, master_key=None):
        """
        åˆå§‹åŒ–åŠ å¯†å™¨
        :param master_key: ä¸»å¯†é’¥ï¼Œå¦‚æœä¸ºNoneåˆ™ç”Ÿæˆæ–°å¯†é’¥
        """
        if master_key:
            self.master_key = master_key
        else:
            # ç”Ÿæˆå®‰å…¨çš„ä¸»å¯†é’¥
            self.master_key = Fernet.generate_key()
        
        self.cipher = Fernet(self.master_key)
    
    def encrypt_field(self, plaintext):
        """åŠ å¯†å•ä¸ªå­—æ®µ"""
        if plaintext is None:
            return None
        
        # å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚
        if isinstance(plaintext, str):
            plaintext = plaintext.encode('utf-8')
        
        # åŠ å¯†æ•°æ®
        encrypted = self.cipher.encrypt(plaintext)
        
        # è¿”å›Base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œä¾¿äºæ•°æ®åº“å­˜å‚¨
        return base64.b64encode(encrypted).decode('utf-8')
    
    def decrypt_field(self, encrypted_text):
        """è§£å¯†å•ä¸ªå­—æ®µ"""
        if encrypted_text is None:
            return None
        
        try:
            # è§£ç Base64å­—ç¬¦ä¸²
            encrypted_bytes = base64.b64decode(encrypted_text.encode('utf-8'))
            
            # è§£å¯†æ•°æ®
            decrypted = self.cipher.decrypt(encrypted_bytes)
            
            # å°†å­—èŠ‚è½¬æ¢å›å­—ç¬¦ä¸²
            return decrypted.decode('utf-8')
        except Exception as e:
            # è®°å½•è§£å¯†é”™è¯¯ï¼Œä½†ä¸æš´éœ²å…·ä½“ä¿¡æ¯
            raise ValueError("è§£å¯†å¤±è´¥ï¼Œå¯èƒ½æ˜¯å¯†é’¥ä¸æ­£ç¡®æˆ–æ•°æ®å·²æŸå")
    
    def encrypt_sensitive_data(self, data_dict, sensitive_fields):
        """
        åŠ å¯†å­—å…¸ä¸­çš„æ•æ„Ÿå­—æ®µ
        :param data_dict: åŒ…å«æ•°æ®çš„å­—å…¸
        :param sensitive_fields: éœ€è¦åŠ å¯†çš„å­—æ®µåˆ—è¡¨
        :return: åŠ å¯†åçš„å­—å…¸
        """
        encrypted_dict = data_dict.copy()
        
        for field in sensitive_fields:
            if field in encrypted_dict:
                encrypted_dict[field] = self.encrypt_field(encrypted_dict[field])
        
        return encrypted_dict
    
    def decrypt_sensitive_data(self, data_dict, sensitive_fields):
        """
        è§£å­—å…¸ä¸­çš„æ•æ„Ÿå­—æ®µ
        :param data_dict: åŒ…å«åŠ å¯†æ•°æ®çš„å­—å…¸
        :param sensitive_fields: éœ€è¦è§£å¯†çš„å­—æ®µåˆ—è¡¨
        :return: è§£å¯†åçš„å­—å…¸
        """
        decrypted_dict = data_dict.copy()
        
        for field in sensitive_fields:
            if field in decrypted_dict:
                decrypted_dict[field] = self.decrypt_field(decrypted_dict[field])
        
        return decrypted_dict
    
    @staticmethod
    def generate_key_from_password(password, salt=None):
        """ä»å¯†ç æ´¾ç”ŸåŠ å¯†å¯†é’¥"""
        if salt is None:
            salt = os.urandom(16)  # ç”Ÿæˆéšæœºç›
        
        # ä½¿ç”¨PBKDF2ä»å¯†ç æ´¾ç”Ÿå¯†é’¥
        kdf = PBKDF2(
            algorithm=hashes.SHA256(),
            length=32,
            salt=salt,
            iterations=100000,
        )
        
        key = base64.urlsafe_b64encode(kdf.derive(password.encode()))
        return key, salt

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # 1. åˆ›å»ºåŠ å¯†å™¨
    encryptor = DatabaseEncryptor()
    
    # 2. æ•æ„Ÿæ•°æ®
    sensitive_data = {
        'id': 1,
        'name': 'å¼ ä¸‰',
        'email': 'zhangsan@example.com',
        'phone': '13800138000',
        'id_card': '110101199001011234',
        'bank_card': '6228480012345678901'
    }
    
    # 3. å®šä¹‰éœ€è¦åŠ å¯†çš„å­—æ®µ
    sensitive_fields = ['phone', 'id_card', 'bank_card']
    
    # 4. åŠ å¯†æ•æ„Ÿå­—æ®µ
    encrypted_data = encryptor.encrypt_sensitive_data(sensitive_data, sensitive_fields)
    print("åŠ å¯†åçš„æ•°æ®:", encrypted_data)
    
    # 5. è§£å¯†æ•°æ®
    decrypted_data = encryptor.decrypt_sensitive_data(encrypted_data, sensitive_fields)
    print("è§£å¯†åçš„æ•°æ®:", decrypted_data)
    
    # 6. ä¿å­˜ä¸»å¯†é’¥ï¼ˆå®‰å…¨å­˜å‚¨ï¼ï¼‰
    print(f"ä¸»å¯†é’¥ï¼ˆå¦¥å–„ä¿å­˜ï¼‰: {encryptor.master_key.decode()}")</code></pre>
            </div>

            <h3>3. MySQLé€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶é…ç½®</button>
                <pre><code># MySQL 8.0 é€æ˜æ•°æ®åŠ å¯†é…ç½®

# 1. å®‰è£…TDEç»„ä»¶ï¼ˆä¼ä¸šç‰ˆåŠŸèƒ½ï¼‰
INSTALL COMPONENT "file://component_encryption";

# 2. æŸ¥çœ‹TDEçŠ¶æ€
SELECT * FROM information_schema.`PLUGINS` 
WHERE PLUGIN_NAME LIKE '%keyring%';

# 3. é…ç½®keyringæ’ä»¶ï¼ˆé€‰æ‹©ä¸€ç§ï¼‰
# é€‰é¡¹1: keyring_fileï¼ˆæ–‡ä»¶æ–¹å¼ï¼‰
[mysqld]
early-plugin-load=keyring_file.so
keyring_file_data=/var/lib/mysql-keyring/keyring

# é€‰é¡¹2: keyring_encrypted_fileï¼ˆåŠ å¯†æ–‡ä»¶æ–¹å¼ï¼‰
[mysqld]
early-plugin-load=keyring_encrypted_file.so
keyring_encrypted_file_data=/var/lib/mysql-keyring/keyring
keyring_encrypted_file_password=StrongKeyringPass123!

# 4. åˆ›å»ºåŠ å¯†è¡¨ç©ºé—´
CREATE TABLESPACE `encrypted_ts` 
ADD DATAFILE 'encrypted_ts.ibd' 
ENGINE=InnoDB 
ENCRYPTION='Y';

# 5. åˆ›å»ºä½¿ç”¨åŠ å¯†è¡¨ç©ºé—´çš„è¡¨
CREATE TABLE sensitive_data (
    id INT PRIMARY KEY AUTO_INCREMENT,
    card_number VARCHAR(19) NOT NULL,
    card_holder VARCHAR(100) NOT NULL,
    expiry_date DATE NOT NULL,
    cvv VARCHAR(4) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) TABLESPACE encrypted_ts;

# 6. åŠ å¯†ç°æœ‰è¡¨
ALTER TABLE existing_sensitive_table ENCRYPTION='Y';

# 7. æŸ¥çœ‹åŠ å¯†çŠ¶æ€
SELECT 
    TABLE_SCHEMA,
    TABLE_NAME,
    CREATE_OPTIONS
FROM information_schema.TABLES 
WHERE CREATE_OPTIONS LIKE '%ENCRYPTION%';

# 8. è¡¨ç©ºé—´åŠ å¯†ä¿¡æ¯
SELECT 
    SPACE, 
    NAME, 
    SPACE_TYPE, 
    ENCRYPTION 
FROM information_schema.INNODB_TABLESPACES 
WHERE ENCRYPTION = 'Y';

# 9. å¤‡ä»½åŠ å¯†è¡¨ç©ºé—´ï¼ˆéœ€è¦ç‰¹åˆ«å¤„ç†ï¼‰
# å¤‡ä»½å‰éœ€è¦é”å®šè¡¨
FLUSH TABLES sensitive_data FOR EXPORT;
# å¤åˆ¶.ibdå’Œ.cfgæ–‡ä»¶
# å®Œæˆåè§£é”
UNLOCK TABLES;

# 10. ç›‘æ§åŠ å¯†æ€§èƒ½
SHOW STATUS LIKE 'keyring%';
SHOW GLOBAL STATUS LIKE 'innodb_encryption%';

# æ³¨æ„äº‹é¡¹ï¼š
# 1. TDEåªåŠ å¯†æ•°æ®æ–‡ä»¶ï¼Œä¸åŠ å¯†æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶æˆ–å†…å­˜ä¸­çš„æ•°æ®
# 2. å¤‡ä»½å’Œæ¢å¤éœ€è¦ç‰¹æ®Šå¤„ç†
# 3. åŠ å¯†ä¼šå½±å“æ€§èƒ½ï¼ˆé€šå¸¸5-10%ï¼‰
# 4. éœ€è¦ä¼ä¸šç‰ˆMySQL
# 5. å¯†é’¥ç®¡ç†æ˜¯å…³é”®ï¼Œç¡®ä¿å¯†é’¥å®‰å…¨</code></pre>
            </div>
        </section>

        <!-- å®šæœŸå¤‡ä»½ä¸æ¢å¤ç­–ç•¥ -->
        <section class="content-section" id="backup">
            <h2>äº”ã€å®šæœŸå¤‡ä»½ä¸æ¢å¤ç­–ç•¥</h2>
            
            <div class="warning-tip">
                <strong>ğŸ’¾ å¤‡ä»½åŸåˆ™ï¼ˆ3-2-1è§„åˆ™ï¼‰ï¼š</strong>
                <p>è‡³å°‘ä¿å­˜3ä»½å¤‡ä»½ï¼Œä½¿ç”¨2ç§ä¸åŒä»‹è´¨ï¼Œå…¶ä¸­1ä»½å­˜æ”¾åœ¨å¼‚åœ°ã€‚è¿™æ˜¯æ•°æ®ä¿æŠ¤çš„æœ€ä½³å®è·µã€‚</p>
            </div>

            <h3>1. æ•°æ®åº“å¤‡ä»½æµç¨‹</h3>
            
            <div class="backup-flow">
                <div class="flow-step">
                    <div class="flow-step-number">1</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">ğŸ“‹</span>
                        <span>ç¡®å®šå¤‡ä»½ç­–ç•¥ï¼ˆå…¨é‡/å¢é‡/å·®å¼‚ï¼‰</span>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="flow-step-number">2</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">â°</span>
                        <span>è®¾ç½®å¤‡ä»½è®¡åˆ’ï¼ˆè‡ªåŠ¨åŒ–è°ƒåº¦ï¼‰</span>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="flow-step-number">3</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">ğŸ”</span>
                        <span>æ‰§è¡ŒåŠ å¯†å¤‡ä»½ï¼ˆä¿æŠ¤å¤‡ä»½æ•°æ®ï¼‰</span>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="flow-step-number">4</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">ğŸ“Š</span>
                        <span>éªŒè¯å¤‡ä»½å®Œæ•´æ€§ï¼ˆå®šæœŸæµ‹è¯•ï¼‰</span>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="flow-step-number">5</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">ğŸŒ</span>
                        <span>å¼‚åœ°å­˜å‚¨å¤‡ä»½ï¼ˆç¾éš¾æ¢å¤ï¼‰</span>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="flow-step-number">6</div>
                    <div class="flow-step-content">
                        <span class="flow-icon">ğŸ“ˆ</span>
                        <span>ç›‘æ§å¤‡ä»½çŠ¶æ€ï¼ˆåŠæ—¶å‘Šè­¦ï¼‰</span>
                    </div>
                </div>
            </div>

            <h3>2. è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶è„šæœ¬</button>
                <pre><code>#!/bin/bash
# mysql_automated_backup.sh
# MySQLè‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬

# é…ç½®å‚æ•°
DB_HOST="localhost"
DB_PORT="3306"
DB_USER="backup_user"
DB_PASS="BackupPass123!"
BACKUP_DIR="/data/backups/mysql"
RETENTION_DAYS=30
ENCRYPT_KEY="/etc/mysql/backup_key.pem"
LOG_FILE="/var/log/mysql_backup.log"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_NAME="backup_${DATE}"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p ${BACKUP_DIR}/daily
mkdir -p ${BACKUP_DIR}/weekly
mkdir -p ${BACKUP_DIR}/monthly

# æ—¥å¿—å‡½æ•°
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a $LOG_FILE
}

# é”™è¯¯å¤„ç†å‡½æ•°
handle_error() {
    log_message "ERROR: $1"
    # å‘é€å‘Šè­¦é‚®ä»¶
    echo "MySQLå¤‡ä»½å¤±è´¥: $1" | mail -s "MySQLå¤‡ä»½å¤±è´¥å‘Šè­¦" admin@example.com
    exit 1
}

# æ£€æŸ¥MySQLè¿æ¥
check_mysql_connection() {
    if ! mysqladmin -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS ping > /dev/null 2>&1; then
        handle_error "æ— æ³•è¿æ¥åˆ°MySQLæœåŠ¡å™¨"
    fi
    log_message "MySQLè¿æ¥æ£€æŸ¥æˆåŠŸ"
}

# æ‰§è¡Œå…¨é‡å¤‡ä»½
perform_full_backup() {
    log_message "å¼€å§‹æ‰§è¡Œå…¨é‡å¤‡ä»½..."
    
    # è·å–æ‰€æœ‰æ•°æ®åº“ï¼ˆæ’é™¤ç³»ç»Ÿæ•°æ®åº“ï¼‰
    DATABASES=$(mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "SHOW DATABASES;" | grep -Ev "(Database|information_schema|performance_schema|mysql|sys)")
    
    for DB in $DATABASES; do
        log_message "å¤‡ä»½æ•°æ®åº“: $DB"
        
        # å¤‡ä»½å•ä¸ªæ•°æ®åº“
        BACKUP_FILE="${BACKUP_DIR}/daily/${BACKUP_NAME}_${DB}.sql"
        
        # ä½¿ç”¨mysqldumpå¤‡ä»½
        if ! mysqldump -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS \
            --single-transaction \
            --routines \
            --triggers \
            --events \
            --add-drop-database \
            --databases "$DB" > "$BACKUP_FILE"; then
            handle_error "å¤‡ä»½æ•°æ®åº“ $DB å¤±è´¥"
        fi
        
        # å‹ç¼©å¤‡ä»½æ–‡ä»¶
        log_message "å‹ç¼©å¤‡ä»½æ–‡ä»¶: $BACKUP_FILE"
        gzip "$BACKUP_FILE"
        
        # åŠ å¯†å¤‡ä»½æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
        if [ -f "$ENCRYPT_KEY" ]; then
            log_message "åŠ å¯†å¤‡ä»½æ–‡ä»¶"
            ENCRYPTED_FILE="${BACKUP_FILE}.gz.enc"
            openssl enc -aes-256-cbc -salt -in "${BACKUP_FILE}.gz" -out "$ENCRYPTED_FILE" -pass file:"$ENCRYPT_KEY"
            
            # åˆ é™¤æœªåŠ å¯†çš„å‹ç¼©æ–‡ä»¶
            rm "${BACKUP_FILE}.gz"
            log_message "åŠ å¯†å®Œæˆ: $ENCRYPTED_FILE"
        fi
        
        # éªŒè¯å¤‡ä»½æ–‡ä»¶
        if [ -f "${BACKUP_FILE}.gz" ] || [ -f "$ENCRYPTED_FILE" ]; then
            log_message "æ•°æ®åº“ $DB å¤‡ä»½æˆåŠŸ"
        else
            handle_error "æ•°æ®åº“ $DB å¤‡ä»½æ–‡ä»¶åˆ›å»ºå¤±è´¥"
        fi
    done
    
    log_message "å…¨é‡å¤‡ä»½å®Œæˆ"
}

# æ‰§è¡Œå¢é‡å¤‡ä»½ï¼ˆéœ€è¦å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼‰
perform_incremental_backup() {
    log_message "å¼€å§‹æ‰§è¡Œå¢é‡å¤‡ä»½..."
    
    # åˆ·æ–°äºŒè¿›åˆ¶æ—¥å¿—
    mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "FLUSH BINARY LOGS;"
    
    # è·å–å½“å‰äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶
    CURRENT_BINLOG=$(mysql -h $DB_HOST -P $DB_PORT -u $DB_USER -p$DB_PASS -e "SHOW MASTER STATUS\G" | grep "File:" | awk '{print $2}')
    
    # å¤‡ä»½äºŒè¿›åˆ¶æ—¥å¿—
    BINLOG_BACKUP_DIR="${BACKUP_DIR}/binlogs"
    mkdir -p $BINLOG_BACKUP_DIR
    
    # å¤åˆ¶äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼ˆé™¤äº†å½“å‰æ­£åœ¨å†™çš„ï¼‰
    for binlog in $(ls /var/lib/mysql/mysql-bin.* 2>/dev/null); do
        if [ "$(basename $binlog)" != "$CURRENT_BINLOG" ]; then
            log_message "å¤‡ä»½äºŒè¿›åˆ¶æ—¥å¿—: $(basename $binlog)"
            cp "$binlog" "$BINLOG_BACKUP_DIR/"
        fi
    done
    
    log_message "å¢é‡å¤‡ä»½å®Œæˆ"
}

# æ¸…ç†æ—§å¤‡ä»½
cleanup_old_backups() {
    log_message "æ¸…ç†è¶…è¿‡ ${RETENTION_DAYS} å¤©çš„æ—§å¤‡ä»½..."
    
    # æ¸…ç†æ¯æ—¥å¤‡ä»½
    find ${BACKUP_DIR}/daily -name "backup_*.sql.gz" -mtime +${RETENTION_DAYS} -delete
    find ${BACKUP_DIR}/daily -name "backup_*.sql.gz.enc" -mtime +${RETENTION_DAYS} -delete
    
    # æ¸…ç†äºŒè¿›åˆ¶æ—¥å¿—å¤‡ä»½
    find ${BACKUP_DIR}/binlogs -name "mysql-bin.*" -mtime +${RETENTION_DAYS} -delete
    
    log_message "æ—§å¤‡ä»½æ¸…ç†å®Œæˆ"
}

# éªŒè¯å¤‡ä»½å®Œæ•´æ€§
verify_backup_integrity() {
    log_message "éªŒè¯å¤‡ä»½å®Œæ•´æ€§..."
    
    # éšæœºé€‰æ‹©ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶è¿›è¡ŒéªŒè¯
    BACKUP_FILE=$(find ${BACKUP_DIR}/daily -name "*.sql.gz" -type f | head -1)
    
    if [ -n "$BACKUP_FILE" ]; then
        # å¦‚æœæ˜¯åŠ å¯†æ–‡ä»¶ï¼Œå…ˆè§£å¯†
        if [[ "$BACKUP_FILE" == *.enc ]]; then
            TEMP_FILE="/tmp/backup_verify.sql.gz"
            openssl enc -aes-256-cbc -d -in "$BACKUP_FILE" -out "$TEMP_FILE" -pass file:"$ENCRYPT_KEY" 2>/dev/null
            
            if [ $? -eq 0 ]; then
                # éªŒè¯gzipæ–‡ä»¶å®Œæ•´æ€§
                if gzip -t "$TEMP_FILE" 2>/dev/null; then
                    log_message "å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§éªŒè¯æˆåŠŸ: $BACKUP_FILE"
                    rm "$TEMP_FILE"
                else
                    log_message "WARNING: å¤‡ä»½æ–‡ä»¶å¯èƒ½æŸå: $BACKUP_FILE"
                fi
            else
                log_message "WARNING: æ— æ³•è§£å¯†å¤‡ä»½æ–‡ä»¶: $BACKUP_FILE"
            fi
        else
            # ç›´æ¥éªŒè¯gzipæ–‡ä»¶
            if gzip -t "$BACKUP_FILE" 2>/dev/null; then
                log_message "å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§éªŒè¯æˆåŠŸ: $BACKUP_FILE"
            else
                log_message "WARNING: å¤‡ä»½æ–‡ä»¶å¯èƒ½æŸå: $BACKUP_FILE"
            fi
        fi
    else
        log_message "æ²¡æœ‰æ‰¾åˆ°å¤‡ä»½æ–‡ä»¶è¿›è¡ŒéªŒè¯"
    fi
}

# ç”Ÿæˆå¤‡ä»½æŠ¥å‘Š
generate_backup_report() {
    log_message "ç”Ÿæˆå¤‡ä»½æŠ¥å‘Š..."
    
    REPORT_FILE="/tmp/backup_report_${DATE}.txt"
    
    echo "=== MySQLå¤‡ä»½æŠ¥å‘Š ===" > $REPORT_FILE
    echo "ç”Ÿæˆæ—¶é—´: $(date)" >> $REPORT_FILE
    echo "å¤‡ä»½ç›®å½•: $BACKUP_DIR" >> $REPORT_FILE
    echo "=====================" >> $REPORT_FILE
    
    echo -e "\nå¤‡ä»½æ–‡ä»¶ç»Ÿè®¡:" >> $REPORT_FILE
    echo "æ¯æ—¥å¤‡ä»½æ–‡ä»¶æ•°: $(find ${BACKUP_DIR}/daily -type f | wc -l)" >> $REPORT_FILE
    echo "äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶æ•°: $(find ${BACKUP_DIR}/binlogs -type f | wc -l)" >> $REPORT_FILE
    echo "å¤‡ä»½æ€»å¤§å°: $(du -sh $BACKUP_DIR | awk '{print $1}')" >> $REPORT_FILE
    
    echo -e "\næœ€è¿‘å¤‡ä»½æ–‡ä»¶:" >> $REPORT_FILE
    find ${BACKUP_DIR}/daily -type f -name "*.gz" -o -name "*.enc" | sort -r | head -5 | while read file; do
        echo "  $(basename $file) - $(stat -c %y $file | cut -d'.' -f1) - $(du -h $file | awk '{print $1}')" >> $REPORT_FILE
    done
    
    # å‘é€æŠ¥å‘Šé‚®ä»¶
    mail -s "MySQLå¤‡ä»½æŠ¥å‘Š ${DATE}" admin@example.com < $REPORT_FILE
    log_message "å¤‡ä»½æŠ¥å‘Šå·²å‘é€"
    
    rm $REPORT_FILE
}

# ä¸»å‡½æ•°
main() {
    log_message "=== MySQLè‡ªåŠ¨åŒ–å¤‡ä»½å¼€å§‹ ==="
    
    # 1. æ£€æŸ¥MySQLè¿æ¥
    check_mysql_connection
    
    # 2. åˆ¤æ–­å¤‡ä»½ç±»å‹
    DAY_OF_WEEK=$(date +%u)  # 1=å‘¨ä¸€, 7=å‘¨æ—¥
    DAY_OF_MONTH=$(date +%d)
    
    if [ "$DAY_OF_WEEK" = "1" ]; then
        # æ¯å‘¨ä¸€æ‰§è¡Œå…¨é‡å¤‡ä»½
        log_message "å‘¨ä¸€æ‰§è¡Œå…¨é‡å¤‡ä»½"
        perform_full_backup
        
        # å¤åˆ¶åˆ°å‘¨å¤‡ä»½ç›®å½•
        cp ${BACKUP_DIR}/daily/backup_*.gz ${BACKUP_DIR}/weekly/ 2>/dev/null || true
        cp ${BACKUP_DIR}/daily/backup_*.gz.enc ${BACKUP_DIR}/weekly/ 2>/dev/null || true
        
    elif [ "$DAY_OF_MONTH" = "01" ]; then
        # æ¯æœˆ1å·æ‰§è¡Œå…¨é‡å¤‡ä»½
        log_message "æ¯æœˆ1å·æ‰§è¡Œå…¨é‡å¤‡ä»½"
        perform_full_backup
        
        # å¤åˆ¶åˆ°æœˆå¤‡ä»½ç›®å½•
        cp ${BACKUP_DIR}/daily/backup_*.gz ${BACKUP_DIR}/monthly/ 2>/dev/null || true
        cp ${BACKUP_DIR}/daily/backup_*.gz.enc ${BACKUP_DIR}/monthly/ 2>/dev/null || true
        
    else
        # å…¶ä»–æ—¶é—´æ‰§è¡Œå¢é‡å¤‡ä»½
        log_message "æ‰§è¡Œå¢é‡å¤‡ä»½"
        perform_incremental_backup
    fi
    
    # 3. æ¸…ç†æ—§å¤‡ä»½
    cleanup_old_backups
    
    # 4. éªŒè¯å¤‡ä»½å®Œæ•´æ€§
    verify_backup_integrity
    
    # 5. ç”Ÿæˆå¤‡ä»½æŠ¥å‘Š
    generate_backup_report
    
    log_message "=== MySQLè‡ªåŠ¨åŒ–å¤‡ä»½å®Œæˆ ==="
}

# æ‰§è¡Œä¸»å‡½æ•°
main</code></pre>
            </div>

            <h3>3. æ•°æ®åº“æ¢å¤ç­–ç•¥</h3>
            <table class="security-table">
                <thead>
                    <tr>
                        <th>æ•…éšœç±»å‹</th>
                        <th>æ¢å¤ç­–ç•¥</th>
                        <th>æ¢å¤æ—¶é—´ç›®æ ‡ (RTO)</th>
                        <th>æ¢å¤ç‚¹ç›®æ ‡ (RPO)</th>
                        <th>æ¢å¤æ­¥éª¤</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>å•è¡¨æŸå</strong></td>
                        <td>è¡¨çº§æ¢å¤</td>
                        <td>30åˆ†é’Ÿ</td>
                        <td>15åˆ†é’Ÿ</td>
                        <td>1. ä»å¤‡ä»½æ¢å¤è¡¨<br>2. åº”ç”¨binlogå¢é‡</td>
                    </tr>
                    <tr>
                        <td><strong>å•åº“æŸå</strong></td>
                        <td>åº“çº§æ¢å¤</td>
                        <td>1å°æ—¶</td>
                        <td>15åˆ†é’Ÿ</td>
                        <td>1. æ¢å¤å®Œæ•´å¤‡ä»½<br>2. åº”ç”¨å¢é‡æ—¥å¿—</td>
                    </tr>
                    <tr>
                        <td><strong>æœåŠ¡å™¨æ•…éšœ</strong></td>
                        <td>å…¨å®ä¾‹æ¢å¤</td>
                        <td>2-4å°æ—¶</td>
                        <td>1å°æ—¶</td>
                        <td>1. æ–°æœåŠ¡å™¨å‡†å¤‡<br>2. æ¢å¤æ‰€æœ‰æ•°æ®</td>
                    </tr>
                    <tr>
                        <td><strong>æ•°æ®ä¸­å¿ƒæ•…éšœ</strong></td>
                        <td>å¼‚åœ°ç¾å¤‡åˆ‡æ¢</td>
                        <td>4-8å°æ—¶</td>
                        <td>2å°æ—¶</td>
                        <td>1. æ¿€æ´»ç¾å¤‡ä¸­å¿ƒ<br>2. DNSåˆ‡æ¢</td>
                    </tr>
                    <tr>
                        <td><strong>é€»è¾‘é”™è¯¯ï¼ˆè¯¯åˆ ï¼‰</strong></td>
                        <td>æ—¶é—´ç‚¹æ¢å¤</td>
                        <td>2å°æ—¶</td>
                        <td>0ï¼ˆç²¾ç¡®æ¢å¤ï¼‰</td>
                        <td>1. æ¢å¤åˆ°è¯¯æ“ä½œå‰<br>2. è·³è¿‡é”™è¯¯äº‹åŠ¡</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶è„šæœ¬</button>
<pre><code>#!/bin/bash
# mysql_recovery_script.sh
# MySQLæ•°æ®åº“æ¢å¤è„šæœ¬

# é…ç½®å‚æ•°
BACKUP_DIR="/data/backups/mysql"
RESTORE_DIR="/tmp/mysql_restore"
MYSQL_DATA_DIR="/var/lib/mysql"
LOG_FILE="/var/log/mysql_recovery.log"
DATE_TO_RESTORE="2025-12-10 14:30:00"  # æ¢å¤åˆ°çš„æ—¶é—´ç‚¹

# æ—¥å¿—å‡½æ•°
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a $LOG_FILE
}

# é”™è¯¯å¤„ç†
handle_error() {
    log_message "ERROR: $1"
    exit 1
}

# å‡†å¤‡å·¥ä½œ
prepare_restore() {
    log_message "å‡†å¤‡æ¢å¤ç¯å¢ƒ..."
    
    # åœæ­¢MySQLæœåŠ¡
    systemctl stop mysql
    if [ $? -ne 0 ]; then
        handle_error "åœæ­¢MySQLæœåŠ¡å¤±è´¥"
    fi
    
    # å¤‡ä»½å½“å‰æ•°æ®ç›®å½•
    if [ -d "$MYSQL_DATA_DIR" ]; then
        log_message "å¤‡ä»½å½“å‰æ•°æ®ç›®å½•..."
        BACKUP_OLD_DATA="/tmp/mysql_data_backup_$(date +%Y%m%d_%H%M%S)"
        cp -r "$MYSQL_DATA_DIR" "$BACKUP_OLD_DATA"
        log_message "å½“å‰æ•°æ®å·²å¤‡ä»½åˆ°: $BACKUP_OLD_DATA"
    fi
    
    # æ¸…ç†æ•°æ®ç›®å½•
    log_message "æ¸…ç†æ•°æ®ç›®å½•..."
    rm -rf ${MYSQL_DATA_DIR}/*
    
    # åˆ›å»ºæ¢å¤ç›®å½•
    mkdir -p "$RESTORE_DIR"
}

# æ¢å¤å…¨é‡å¤‡ä»½
restore_full_backup() {
    log_message "æ¢å¤å…¨é‡å¤‡ä»½..."
    
    # æŸ¥æ‰¾æœ€æ–°çš„å…¨é‡å¤‡ä»½
    LATEST_BACKUP=$(find ${BACKUP_DIR}/daily -name "backup_*.sql.gz" -type f | sort -r | head -1)
    
    if [ -z "$LATEST_BACKUP" ]; then
        handle_error "æœªæ‰¾åˆ°å…¨é‡å¤‡ä»½æ–‡ä»¶"
    fi
    
    log_message "ä½¿ç”¨å¤‡ä»½æ–‡ä»¶: $LATEST_BACKUP"
    
    # è§£å‹å¤‡ä»½æ–‡ä»¶
    gunzip -c "$LATEST_BACKUP" > "${RESTORE_DIR}/full_backup.sql"
    
    if [ $? -ne 0 ]; then
        handle_error "è§£å‹å¤‡ä»½æ–‡ä»¶å¤±è´¥"
    fi
    
    # æ¢å¤å¤‡ä»½
    log_message "æ‰§è¡Œå…¨é‡å¤‡ä»½æ¢å¤..."
    mysql < "${RESTORE_DIR}/full_backup.sql"
    
    if [ $? -ne 0 ]; then
        handle_error "å…¨é‡å¤‡ä»½æ¢å¤å¤±è´¥"
    fi
    
    log_message "å…¨é‡å¤‡ä»½æ¢å¤å®Œæˆ"
}

# åº”ç”¨å¢é‡å¤‡ä»½ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰
apply_incremental_backup() {
    log_message "åº”ç”¨å¢é‡å¤‡ä»½..."
    
    # æŸ¥æ‰¾å…¨é‡å¤‡ä»½çš„æ—¶é—´
    BACKUP_TIMESTAMP=$(echo "$LATEST_BACKUP" | grep -o '[0-9]\{8\}_[0-9]\{6\}')
    BACKUP_DATETIME="${BACKUP_TIMESTAMP:0:4}-${BACKUP_TIMESTAMP:4:2}-${BACKUP_TIMESTAMP:6:2} ${BACKUP_TIMESTAMP:9:2}:${BACKUP_TIMESTAMP:11:2}:${BACKUP_TIMESTAMP:13:2}"
    
    log_message "å…¨é‡å¤‡ä»½æ—¶é—´: $BACKUP_DATETIME"
    log_message "æ¢å¤åˆ°æ—¶é—´ç‚¹: $DATE_TO_RESTORE"
    
    # ç”ŸæˆäºŒè¿›åˆ¶æ—¥å¿—åˆ—è¡¨
    BINLOG_FILES=$(find ${BACKUP_DIR}/binlogs -name "mysql-bin.*" -type f | sort)
    
    if [ -n "$BINLOG_FILES" ]; then
        log_message "åº”ç”¨äºŒè¿›åˆ¶æ—¥å¿—..."
        
        # åˆå¹¶æ‰€æœ‰äºŒè¿›åˆ¶æ—¥å¿—
        for binlog in $BINLOG_FILES; do
            log_message "å¤„ç†äºŒè¿›åˆ¶æ—¥å¿—: $(basename $binlog)"
            mysqlbinlog "$binlog" >> "${RESTORE_DIR}/all_binlogs.sql"
        done
        
        # åº”ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆåˆ°æŒ‡å®šæ—¶é—´ç‚¹ï¼‰
        mysqlbinlog --stop-datetime="$DATE_TO_RESTORE" \
                    --start-datetime="$BACKUP_DATETIME" \
                    ${BACKUP_DIR}/binlogs/mysql-bin.* > "${RESTORE_DIR}/incremental.sql"
        
        if [ -s "${RESTORE_DIR}/incremental.sql" ]; then
            mysql < "${RESTORE_DIR}/incremental.sql"
            if [ $? -ne 0 ]; then
                handle_error "åº”ç”¨å¢é‡å¤‡ä»½å¤±è´¥"
            fi
            log_message "å¢é‡å¤‡ä»½åº”ç”¨å®Œæˆ"
        else
            log_message "æ²¡æœ‰éœ€è¦åº”ç”¨çš„å¢é‡å¤‡ä»½"
        fi
    else
        log_message "æ²¡æœ‰æ‰¾åˆ°äºŒè¿›åˆ¶æ—¥å¿—å¤‡ä»½"
    fi
}

# æ¢å¤åå¤„ç†
post_restore() {
    log_message "æ‰§è¡Œæ¢å¤åå¤„ç†..."
    
    # ä¿®å¤æƒé™
    chown -R mysql:mysql "$MYSQL_DATA_DIR"
    
    # å¯åŠ¨MySQLæœåŠ¡
    systemctl start mysql
    if [ $? -ne 0 ]; then
        handle_error "å¯åŠ¨MySQLæœåŠ¡å¤±è´¥"
    fi
    
    # æ£€æŸ¥MySQLçŠ¶æ€
    sleep 5
    if mysqladmin ping > /dev/null 2>&1; then
        log_message "MySQLæœåŠ¡å¯åŠ¨æˆåŠŸ"
    else
        handle_error "MySQLæœåŠ¡å¯åŠ¨åæ£€æŸ¥å¤±è´¥"
    fi
    
    # éªŒè¯æ•°æ®å®Œæ•´æ€§
    log_message "éªŒè¯æ•°æ®å®Œæ•´æ€§..."
    mysql -e "SHOW DATABASES;"
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm -rf "$RESTORE_DIR"
    
    log_message "æ•°æ®åº“æ¢å¤å®Œæˆ"
}

# ä¸»å‡½æ•°
main() {
    log_message "=== å¼€å§‹æ•°æ®åº“æ¢å¤ ==="
    
    # 1. å‡†å¤‡å·¥ä½œ
    prepare_restore
    
    # 2. æ¢å¤å…¨é‡å¤‡ä»½
    restore_full_backup
    
    # 3. åº”ç”¨å¢é‡å¤‡ä»½
    apply_incremental_backup
    
    # 4. æ¢å¤åå¤„ç†
    post_restore
    
    log_message "=== æ•°æ®åº“æ¢å¤å®Œæˆ ==="
}

# æ‰§è¡Œæ¢å¤ï¼ˆéœ€è¦æ‰‹åŠ¨ç¡®è®¤ï¼‰
read -p "ç¡®è®¤è¦æ¢å¤æ•°æ®åº“å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚(y/n): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    main
else
    echo "æ¢å¤æ“ä½œå·²å–æ¶ˆ"
fi</code></pre>
            </div>
        </section>

        <!-- ç›‘æ§ä¸å®¡è®¡æœºåˆ¶ -->
        <section class="content-section" id="monitoring">
            <h2>å…­ã€ç›‘æ§ä¸å®¡è®¡æœºåˆ¶</h2>
            
            <h3>1. æ•°æ®åº“æ´»åŠ¨å®¡è®¡</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶é…ç½®</button>
                <pre><code># MySQL å®¡è®¡é…ç½®

# 1. å¯ç”¨é€šç”¨æŸ¥è¯¢æ—¥å¿—ï¼ˆç”Ÿäº§ç¯å¢ƒæ…ç”¨ï¼Œæ€§èƒ½å½±å“å¤§ï¼‰
[mysqld]
general_log = 1
general_log_file = /var/log/mysql/general.log
log_output = FILE

# 2. å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2  # è¶…è¿‡2ç§’çš„æŸ¥è¯¢
log_queries_not_using_indexes = 1  # è®°å½•æœªä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢

# 3. å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆç”¨äºå¤åˆ¶å’Œæ¢å¤ï¼‰
log_bin = /var/log/mysql/mysql-bin.log
expire_logs_days = 30
max_binlog_size = 100M
binlog_format = ROW  # ROWæ ¼å¼æ›´å®‰å…¨ï¼Œè®°å½•è¡Œçº§å˜æ›´

# 4. å¯ç”¨é”™è¯¯æ—¥å¿—
log_error = /var/log/mysql/error.log

# 5. MySQLä¼ä¸šç‰ˆå®¡è®¡æ’ä»¶ï¼ˆä¼ä¸šç‰ˆåŠŸèƒ½ï¼‰
INSTALL PLUGIN audit_log SONAME 'audit_log.so';

[mysqld]
audit_log_format = JSON
audit_log_policy = ALL  # è®°å½•æ‰€æœ‰äº‹ä»¶
audit_log_file = /var/log/mysql/audit.log
audit_log_rotate_on_size = 100M
audit_log_rotations = 10

# 6. æŸ¥çœ‹å½“å‰å®¡è®¡é…ç½®
SHOW VARIABLES LIKE '%audit%';

# 7. è‡ªå®šä¹‰å®¡è®¡è§„åˆ™ç¤ºä¾‹
# å®¡è®¡æ•æ„Ÿæ“ä½œ
SET GLOBAL audit_log_filter = '{
    "filter": {
        "class": {
            "name": "general",
            "event": {
                "name": "status",
                "log": true
            }
        }
    }
}';

# 8. ç¬¬ä¸‰æ–¹å®¡è®¡å·¥å…·ï¼šMySQL Enterprise Audit
# æä¾›æ›´å¼ºå¤§çš„å®¡è®¡åŠŸèƒ½ï¼š
# - ç»†ç²’åº¦å®¡è®¡ç­–ç•¥
# - å®æ—¶ç›‘æ§
# - åˆè§„æŠ¥å‘Š
# - æ•°æ®è„±æ•

# 9. ä½¿ç”¨Perconaå®¡è®¡æ’ä»¶ï¼ˆå¼€æºæ›¿ä»£ï¼‰
INSTALL PLUGIN audit_log SONAME 'audit_log.so';

[mysqld]
audit_log_format = JSON
audit_log_handler = FILE
audit_log_file = /var/log/mysql/audit.log
audit_log_policy = ALL
audit_log_rotate_on_size = 100M
audit_log_rotations = 10

# 10. å®¡è®¡æ—¥å¿—åˆ†æè„šæœ¬ç¤ºä¾‹
cat > analyze_audit_log.sh << 'EOF'
#!/bin/bash
# MySQLå®¡è®¡æ—¥å¿—åˆ†æè„šæœ¬

AUDIT_LOG="/var/log/mysql/audit.log"
REPORT_FILE="/tmp/audit_report_$(date +%Y%m%d).txt"

echo "=== MySQLå®¡è®¡æŠ¥å‘Š ===" > $REPORT_FILE
echo "ç”Ÿæˆæ—¶é—´: $(date)" >> $REPORT_FILE
echo "=====================" >> $REPORT_FILE

# åˆ†æç™»å½•å¤±è´¥
echo -e "\n1. ç™»å½•å¤±è´¥ç»Ÿè®¡:" >> $REPORT_FILE
grep '"command":"Connect"' $AUDIT_LOG | grep '"error":"1045"' | wc -l >> $REPORT_FILE

# åˆ†ææ•æ„Ÿæ“ä½œ
echo -e "\n2. æ•æ„Ÿæ“ä½œç»Ÿè®¡:" >> $REPORT_FILE
echo "DROPæ“ä½œ: $(grep -i 'DROP' $AUDIT_LOG | wc -l)" >> $REPORT_FILE
echo "TRUNCATEæ“ä½œ: $(grep -i 'TRUNCATE' $AUDIT_LOG | wc -l)" >> $REPORT_FILE
echo "GRANTæ“ä½œ: $(grep -i 'GRANT' $AUDIT_LOG | wc -l)" >> $REPORT_FILE
echo "REVOKEæ“ä½œ: $(grep -i 'REVOKE' $AUDIT_LOG | wc -l)" >> $REPORT_FILE

# åˆ†æç”¨æˆ·æ´»åŠ¨
echo -e "\n3. ç”¨æˆ·æ´»åŠ¨æ’å:" >> $REPORT_FILE
grep '"command":"Query"' $AUDIT_LOG | grep -o '"user":"[^"]*"' | sort | uniq -c | sort -rn | head -10 >> $REPORT_FILE

# å‘é€æŠ¥å‘Š
mail -s "MySQLå®¡è®¡æŠ¥å‘Š" admin@example.com < $REPORT_FILE
EOF

chmod +x analyze_audit_log.sh</code></pre>
            </div>

            <h3>2. å®æ—¶ç›‘æ§ä¸å‘Šè­¦</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶é…ç½®</button>
                <pre><code># Prometheus + Grafana MySQLç›‘æ§é…ç½®

# 1. å®‰è£…MySQL exporter
# ä¸‹è½½åœ°å€ï¼šhttps://github.com/prometheus/mysqld_exporter

# 2. åˆ›å»ºç›‘æ§ç”¨æˆ·
CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'ExporterPass123!' WITH MAX_USER_CONNECTIONS 3;
GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';

# 3. é…ç½®MySQL exporter
cat > /etc/mysql_exporter.yml << 'EOF'
# MySQL exporteré…ç½®
global:
  scrape_interval: 15s

mysql:
  # ç›‘æ§ç›®æ ‡
  - data_source_name: "exporter:ExporterPass123!@(localhost:3306)/"
    # æ”¶é›†çš„æŒ‡æ ‡
    collect:
      # å…¨å±€çŠ¶æ€
      global_status: true
      # å…¨å±€å˜é‡
      global_variables: true
      # è¿›ç¨‹åˆ—è¡¨
      processlist: true
      # ç”¨æˆ·ç»Ÿè®¡
      user_stats: true
      # è¡¨ç»Ÿè®¡
      table_stats: true
      # ç´¢å¼•ç»Ÿè®¡
      index_stats: true
      # å¤åˆ¶çŠ¶æ€
      slave_status: true
      # InnoDBçŠ¶æ€
      innodb: true
      # äºŒè¿›åˆ¶æ—¥å¿—
      binlog: true
EOF

# 4. å¯åŠ¨exporter
./mysqld_exporter --config.my-cnf=/etc/mysql_exporter.yml --web.listen-address=":9104"

# 5. Prometheusé…ç½®
cat > /etc/prometheus/prometheus.yml << 'EOF'
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'mysql'
    static_configs:
      - targets: ['localhost:9104']
    metrics_path: /metrics
    params:
      format: ['prometheus']
EOF

# 6. å…³é”®ç›‘æ§æŒ‡æ ‡
"""
mysql_global_status_threads_connected   # å½“å‰è¿æ¥æ•°
mysql_global_status_max_used_connections # å†å²æœ€å¤§è¿æ¥æ•°
mysql_global_status_questions           # æŸ¥è¯¢æ€»æ•°
mysql_global_status_slow_queries        # æ…¢æŸ¥è¯¢æ•°
mysql_global_status_innodb_row_lock_time_avg # å¹³å‡è¡Œé”ç­‰å¾…æ—¶é—´
mysql_global_variables_max_connections  # æœ€å¤§è¿æ¥æ•°é™åˆ¶
mysql_global_status_innodb_buffer_pool_pages_free # InnoDBç¼“å†²æ± ç©ºé—²é¡µ
mysql_slave_status_slave_io_running     # ä»åº“IOçº¿ç¨‹çŠ¶æ€
mysql_slave_status_slave_sql_running    # ä»åº“SQLçº¿ç¨‹çŠ¶æ€
"""

# 7. å‘Šè­¦è§„åˆ™ï¼ˆPrometheus rulesï¼‰
cat > /etc/prometheus/rules/mysql_rules.yml << 'EOF'
groups:
  - name: mysql_alerts
    rules:
      # è¿æ¥æ•°è¿‡é«˜å‘Šè­¦
      - alert: MySQLè¿æ¥æ•°è¿‡é«˜
        expr: mysql_global_status_threads_connected / mysql_global_variables_max_connections > 0.8
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "MySQLè¿æ¥æ•°è¶…è¿‡80%"
          description: "å½“å‰è¿æ¥æ•°: {{ $value }}%ï¼Œæ¥è¿‘æœ€å¤§è¿æ¥æ•°é™åˆ¶"
      
      # æ…¢æŸ¥è¯¢è¿‡å¤šå‘Šè­¦
      - alert: MySQLæ…¢æŸ¥è¯¢è¿‡å¤š
        expr: rate(mysql_global_status_slow_queries[5m]) > 10
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "MySQLæ…¢æŸ¥è¯¢æ•°é‡å¼‚å¸¸"
          description: "è¿‡å»5åˆ†é’Ÿå¹³å‡æ¯ç§’æ…¢æŸ¥è¯¢æ•°: {{ $value }}"
      
      # å¤åˆ¶å»¶è¿Ÿå‘Šè­¦
      - alert: MySQLå¤åˆ¶å»¶è¿Ÿ
        expr: mysql_slave_status_seconds_behind_master > 30
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "MySQLä»åº“å¤åˆ¶å»¶è¿Ÿè¶…è¿‡30ç§’"
          description: "å½“å‰å¤åˆ¶å»¶è¿Ÿ: {{ $value }}ç§’"
      
      # InnoDBç¼“å†²æ± å‘½ä¸­ç‡è¿‡ä½
      - alert: InnoDBç¼“å†²æ± å‘½ä¸­ç‡ä½
        expr: (1 - (mysql_global_status_innodb_buffer_pool_reads / mysql_global_status_innodb_buffer_pool_read_requests)) * 100 < 90
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "InnoDBç¼“å†²æ± å‘½ä¸­ç‡ä½äº90%"
          description: "å½“å‰å‘½ä¸­ç‡: {{ $value }}%"
      
      # æ­»é”æ£€æµ‹
      - alert: MySQLæ­»é”é¢‘ç¹
        expr: rate(mysql_global_status_innodb_row_lock_time_avg[5m]) > 1000
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "MySQLæ­»é”æ£€æµ‹"
          description: "å¹³å‡è¡Œé”ç­‰å¾…æ—¶é—´å¼‚å¸¸: {{ $value }}ms"
      
      # ç£ç›˜ç©ºé—´ä¸è¶³
      - alert: MySQLç£ç›˜ç©ºé—´ä¸è¶³
        expr: (1 - (node_filesystem_avail_bytes{mountpoint="/var/lib/mysql"} / node_filesystem_size_bytes{mountpoint="/var/lib/mysql"})) * 100 > 85
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "MySQLæ•°æ®ç›®å½•ç£ç›˜ç©ºé—´ä¸è¶³"
          description: "ç£ç›˜ä½¿ç”¨ç‡: {{ $value }}%"
EOF

# 8. Grafanaä»ªè¡¨æ¿
# å¯¼å…¥MySQLç›‘æ§ä»ªè¡¨æ¿ï¼šhttps://grafana.com/grafana/dashboards/7362-mysql-overview/

# 9. è‡ªå®šä¹‰ç›‘æ§è„šæœ¬
cat > /usr/local/bin/mysql_health_check.sh << 'EOF'
#!/bin/bash
# MySQLå¥åº·æ£€æŸ¥è„šæœ¬

MYSQL_HOST="localhost"
MYSQL_PORT="3306"
MYSQL_USER="health_check"
MYSQL_PASS="HealthCheck123!"

# æ£€æŸ¥MySQLæ˜¯å¦è¿è¡Œ
check_mysql_running() {
    if ! systemctl is-active --quiet mysql; then
        echo "ERROR: MySQLæœåŠ¡æœªè¿è¡Œ"
        return 1
    fi
    echo "âœ“ MySQLæœåŠ¡è¿è¡Œæ­£å¸¸"
    return 0
}

# æ£€æŸ¥MySQLè¿æ¥
check_mysql_connection() {
    if ! mysqladmin -h $MYSQL_HOST -P $MYSQL_PORT -u $MYSQL_USER -p$MYSQL_PASS ping > /dev/null 2>&1; then
        echo "ERROR: æ— æ³•è¿æ¥åˆ°MySQL"
        return 1
    fi
    echo "âœ“ MySQLè¿æ¥æ­£å¸¸"
    return 0
}

# æ£€æŸ¥å¤åˆ¶çŠ¶æ€
check_replication() {
    REPLICATION_STATUS=$(mysql -h $MYSQL_HOST -P $MYSQL_PORT -u $MYSQL_USER -p$MYSQL_PASS -e "SHOW SLAVE STATUS\G" 2>/dev/null)
    
    if [ -n "$REPLICATION_STATUS" ]; then
        IO_RUNNING=$(echo "$REPLICATION_STATUS" | grep "Slave_IO_Running:" | awk '{print $2}')
        SQL_RUNNING=$(echo "$REPLICATION_STATUS" | grep "Slave_SQL_Running:" | awk '{print $2}')
        
        if [ "$IO_RUNNING" = "Yes" ] && [ "$SQL_RUNNING" = "Yes" ]; then
            echo "âœ“ MySQLå¤åˆ¶è¿è¡Œæ­£å¸¸"
            return 0
        else
            echo "ERROR: MySQLå¤åˆ¶å¼‚å¸¸ (IO: $IO_RUNNING, SQL: $SQL_RUNNING)"
            return 1
        fi
    else
        echo "âš ï¸  æœªé…ç½®å¤åˆ¶"
        return 0
    fi
}

# æ£€æŸ¥é”™è¯¯æ—¥å¿—
check_error_log() {
    ERROR_LOG="/var/log/mysql/error.log"
    if [ -f "$ERROR_LOG" ]; then
        RECENT_ERRORS=$(tail -100 "$ERROR_LOG" | grep -E "ERROR|Error|error" | tail -5)
        
        if [ -n "$RECENT_ERRORS" ]; then
            echo "âš ï¸  å‘ç°æœ€è¿‘é”™è¯¯:"
            echo "$RECENT_ERRORS"
            return 1
        else
            echo "âœ“ é”™è¯¯æ—¥å¿—æ­£å¸¸"
            return 0
        fi
    else
        echo "âš ï¸  é”™è¯¯æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨"
        return 0
    fi
}

# ä¸»å‡½æ•°
main() {
    echo "=== MySQLå¥åº·æ£€æŸ¥å¼€å§‹ ==="
    echo "æ£€æŸ¥æ—¶é—´: $(date)"
    echo ""
    
    # æ‰§è¡Œæ£€æŸ¥
    check_mysql_running
    check_mysql_connection
    check_replication
    check_error_log
    
    echo ""
    echo "=== MySQLå¥åº·æ£€æŸ¥å®Œæˆ ==="
}

main
EOF

chmod +x /usr/local/bin/mysql_health_check.sh</code></pre>
            </div>
        </section>

        <!-- ä¼ä¸šçº§æ•°æ®åº“å®‰å…¨æ¶æ„ -->
        <section class="content-section" id="enterprise">
            <h2>ä¸ƒã€ä¼ä¸šçº§æ•°æ®åº“å®‰å…¨æ¶æ„</h2>
            
            <div class="info-tip">
                <strong>ğŸ¢ ä¼ä¸šçº§å®‰å…¨æ¶æ„ç‰¹ç‚¹ï¼š</strong>
                <p>å¤šå±‚é˜²æŠ¤ã€ç»Ÿä¸€ç®¡ç†ã€è‡ªåŠ¨åŒ–è¿ç»´ã€åˆè§„å®¡è®¡ã€å®¹ç¾å¤‡ä»½ã€å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸé›†æˆã€‚</p>
            </div>

            <h3>1. åˆ†å±‚å®‰å…¨æ¶æ„è®¾è®¡</h3>
            
            <div class="security-levels">
                <div class="security-level">
                    <div class="level-number">1</div>
                    <div class="level-content">
                        <div class="level-title">ç‰©ç†å±‚å®‰å…¨</div>
                        <p>æ•°æ®ä¸­å¿ƒè®¿é—®æ§åˆ¶ã€ç¡¬ä»¶åŠ å¯†ã€ç‰©ç†éš”ç¦»ã€ç¯å¢ƒç›‘æ§</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">2</div>
                    <div class="level-content">
                        <div class="level-title">ç½‘ç»œå±‚å®‰å…¨</div>
                        <p>é˜²ç«å¢™ã€VPNã€ç½‘ç»œåˆ†æ®µã€IDS/IPSã€DDoSé˜²æŠ¤ã€WAF</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">3</div>
                    <div class="level-content">
                        <div class="level-title">ä¸»æœºå±‚å®‰å…¨</div>
                        <p>æ“ä½œç³»ç»ŸåŠ å›ºã€æœ€å°åŒ–å®‰è£…ã€å®šæœŸæ‰“è¡¥ã€å…¥ä¾µæ£€æµ‹ã€æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">4</div>
                    <div class="level-content">
                        <div class="level-title">æ•°æ®åº“å±‚å®‰å…¨</div>
                        <p>è®¿é—®æ§åˆ¶ã€æ•°æ®åŠ å¯†ã€å®¡è®¡æ—¥å¿—ã€æ¼æ´ç®¡ç†ã€å¤‡ä»½æ¢å¤</p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">5</div>
                    <div class="level-content">
                        <div class="level-title">åº”ç”¨å±‚å®‰å…¨</div>
                        <p>è¾“å…¥éªŒè¯ã€å‚æ•°åŒ–æŸ¥è¯¢ã€ä¼šè¯ç®¡ç†ã€é”™è¯¯å¤„ç†ã€å®‰å…¨ç¼–ç </p>
                    </div>
                </div>
                
                <div class="security-level">
                    <div class="level-number">6</div>
                    <div class="level-content">
                        <div class="level-title">æ•°æ®å±‚å®‰å…¨</div>
                        <p>æ•°æ®åˆ†ç±»ã€æ•°æ®è„±æ•ã€æ•°æ®é˜²æ³„éœ²ã€æ•°æ®è¡€ç¼˜è¿½è¸ª</p>
                    </div>
                </div>
            </div>

            <h3>2. æ•°æ®åº“å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆDBSDLCï¼‰</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">æŸ¥çœ‹æµç¨‹</button>
                <pre><code># æ•°æ®åº“å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆDBSDLCï¼‰æµç¨‹

"""
é˜¶æ®µ1: éœ€æ±‚åˆ†æ
    - è¯†åˆ«æ•æ„Ÿæ•°æ®
    - å®šä¹‰å®‰å…¨éœ€æ±‚
    - åˆè§„æ€§è¦æ±‚åˆ†æ
    - æ•°æ®åˆ†ç±»åˆ†çº§

é˜¶æ®µ2: è®¾è®¡é˜¶æ®µ
    - å®‰å…¨æ¶æ„è®¾è®¡
    - æƒé™æ¨¡å‹è®¾è®¡
    - åŠ å¯†ç­–ç•¥è®¾è®¡
    - å®¡è®¡æ–¹æ¡ˆè®¾è®¡
    - å¤‡ä»½æ¢å¤ç­–ç•¥

é˜¶æ®µ3: å¼€å‘é˜¶æ®µ
    - å®‰å…¨ç¼–ç è§„èŒƒ
    - å‚æ•°åŒ–æŸ¥è¯¢å®ç°
    - è¾“å…¥éªŒè¯å®ç°
    - é”™è¯¯å¤„ç†è®¾è®¡
    - å®‰å…¨å‡½æ•°å¼€å‘

é˜¶æ®µ4: æµ‹è¯•é˜¶æ®µ
    - å®‰å…¨åŠŸèƒ½æµ‹è¯•
    - æ¸—é€æµ‹è¯•
    - SQLæ³¨å…¥æµ‹è¯•
    - æƒé™æå‡æµ‹è¯•
    - æ•°æ®æ³„éœ²æµ‹è¯•

é˜¶æ®µ5: éƒ¨ç½²é˜¶æ®µ
    - å®‰å…¨é…ç½®åŠ å›º
    - æœ€å°æƒé™é…ç½®
    - åŠ å¯†è¯ä¹¦éƒ¨ç½²
    - ç›‘æ§å‘Šè­¦é…ç½®
    - å¤‡ä»½æ¢å¤æµ‹è¯•

é˜¶æ®µ6: è¿ç»´é˜¶æ®µ
    - å®šæœŸå®‰å…¨æ‰«æ
    - æ¼æ´ç®¡ç†
    - æ—¥å¿—å®¡è®¡åˆ†æ
    - æƒé™å®šæœŸè¯„å®¡
    - å®‰å…¨è¡¥ä¸æ›´æ–°

é˜¶æ®µ7: é€€å½¹é˜¶æ®µ
    - æ•°æ®å®‰å…¨è¿ç§»
    - æ•°æ®å®‰å…¨é”€æ¯
    - æƒé™æ¸…ç†
    - å®¡è®¡è®°å½•å½’æ¡£
"""

# DBSDLCæ£€æŸ¥æ¸…å•
DBSDLC_CHECKLIST = {
    "éœ€æ±‚åˆ†æ": [
        "æ•æ„Ÿæ•°æ®è¯†åˆ«å®Œæˆ",
        "å®‰å…¨éœ€æ±‚æ–‡æ¡£åŒ–",
        "åˆè§„è¦æ±‚æ˜ç¡®",
        "æ•°æ®åˆ†ç±»åˆ†çº§å®Œæˆ"
    ],
    "è®¾è®¡é˜¶æ®µ": [
        "å®‰å…¨æ¶æ„è®¾è®¡è¯„å®¡é€šè¿‡",
        "æƒé™æ¨¡å‹ç¬¦åˆæœ€å°æƒé™åŸåˆ™",
        "åŠ å¯†ç­–ç•¥è®¾è®¡å®Œæˆ",
        "å®¡è®¡æ–¹æ¡ˆæ»¡è¶³åˆè§„è¦æ±‚",
        "å¤‡ä»½æ¢å¤ç­–ç•¥åˆ¶å®š"
    ],
    "å¼€å‘é˜¶æ®µ": [
        "ä»£ç å®‰å…¨æ‰«æé€šè¿‡",
        "æ‰€æœ‰SQLæŸ¥è¯¢ä½¿ç”¨å‚æ•°åŒ–",
        "è¾“å…¥éªŒè¯è¦†ç›–æ‰€æœ‰ç”¨æˆ·è¾“å…¥",
        "é”™è¯¯å¤„ç†ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯",
        "å®‰å…¨å‡½æ•°å•å…ƒæµ‹è¯•é€šè¿‡"
    ],
    "æµ‹è¯•é˜¶æ®µ": [
        "å®‰å…¨åŠŸèƒ½æµ‹è¯•é€šè¿‡",
        "æ¸—é€æµ‹è¯•æ— é«˜å±æ¼æ´",
        "SQLæ³¨å…¥æµ‹è¯•é€šè¿‡",
        "æƒé™æå‡æµ‹è¯•é€šè¿‡",
        "æ•°æ®æ³„éœ²æµ‹è¯•é€šè¿‡"
    ],
    "éƒ¨ç½²é˜¶æ®µ": [
        "å®‰å…¨é…ç½®åŠ å›ºå®Œæˆ",
        "æœ€å°æƒé™é…ç½®éªŒè¯",
        "åŠ å¯†è¯ä¹¦éƒ¨ç½²å®Œæˆ",
        "ç›‘æ§å‘Šè­¦é…ç½®æµ‹è¯•",
        "å¤‡ä»½æ¢å¤æµç¨‹éªŒè¯"
    ],
    "è¿ç»´é˜¶æ®µ": [
        "å®šæœŸå®‰å…¨æ‰«æè®¡åˆ’",
        "æ¼æ´ç®¡ç†æµç¨‹å»ºç«‹",
        "æ—¥å¿—å®¡è®¡åˆ†ææœºåˆ¶",
        "æƒé™å®šæœŸè¯„å®¡è®¡åˆ’",
        "å®‰å…¨è¡¥ä¸æ›´æ–°æµç¨‹"
    ]
}</code></pre>
            </div>

            <h3>3. äº‘æ•°æ®åº“å®‰å…¨æœ€ä½³å®è·µ</h3>
            <div class="security-cards">
                <div class="security-card">
                    <h4><i class="fas fa-shield-alt"></i> ç½‘ç»œéš”ç¦»</h4>
                    <p>ä½¿ç”¨VPCã€å®‰å…¨ç»„ã€ç½‘ç»œACLå®ç°æ•°æ®åº“ç½‘ç»œéš”ç¦»ï¼Œé™åˆ¶è®¿é—®æ¥æºIPã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-key"></i> å¯†é’¥ç®¡ç†</h4>
                    <p>ä½¿ç”¨KMSï¼ˆå¯†é’¥ç®¡ç†æœåŠ¡ï¼‰ç®¡ç†åŠ å¯†å¯†é’¥ï¼Œå®ç°è‡ªåŠ¨å¯†é’¥è½®æ¢ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-history"></i> ç‰ˆæœ¬ç®¡ç†</h4>
                    <p>åŠæ—¶æ›´æ–°æ•°æ®åº“ç‰ˆæœ¬ï¼Œåº”ç”¨å®‰å…¨è¡¥ä¸ï¼Œä½¿ç”¨æ‰˜ç®¡æœåŠ¡è‡ªåŠ¨æ›´æ–°ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-eye"></i> ç›‘æ§å®¡è®¡</h4>
                    <p>å¯ç”¨äº‘æœåŠ¡å•†æä¾›çš„ç›‘æ§å®¡è®¡åŠŸèƒ½ï¼Œå¦‚AWS CloudTrailã€Azure Monitorã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-copy"></i> è‡ªåŠ¨å¤‡ä»½</h4>
                    <p>é…ç½®è‡ªåŠ¨å¤‡ä»½å’Œå¿«ç…§ï¼Œå®ç°è·¨åŒºåŸŸå¤åˆ¶ï¼Œæ»¡è¶³åˆè§„è¦æ±‚ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-user-lock"></i> èº«ä»½ç®¡ç†</h4>
                    <p>ä½¿ç”¨IAMè§’è‰²å’Œç­–ç•¥ç®¡ç†æ•°æ®åº“è®¿é—®æƒé™ï¼Œå®ç°æœ€å°æƒé™åŸåˆ™ã€‚</p>
                </div>
            </div>
        </section>

        <!-- æ€»ç»“ä¸æœ€ä½³å®è·µ -->
        <section class="content-section" id="summary">
            <h2>å…«ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h2>
            
            <div class="success-tip">
                <strong>âœ… æ•°æ®åº“å®‰å…¨åŠ å›ºæ ¸å¿ƒè¦ç‚¹ï¼š</strong>
                <p>1. <strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šæ¯ä¸ªç”¨æˆ·åªèƒ½è®¿é—®å¿…éœ€çš„æ•°æ®<br>
                2. <strong>çºµæ·±é˜²å¾¡</strong>ï¼šå¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œä¸ä¾èµ–å•ä¸€æªæ–½<br>
                3. <strong>åŠ å¯†ä¿æŠ¤</strong>ï¼šä¼ è¾“åŠ å¯†å’Œå­˜å‚¨åŠ å¯†ç›¸ç»“åˆ<br>
                4. <strong>æŒç»­ç›‘æ§</strong>ï¼šå®æ—¶ç›‘æ§ã€å®šæœŸå®¡è®¡ã€åŠæ—¶å“åº”<br>
                5. <strong>å¤‡ä»½æ¢å¤</strong>ï¼šå®šæœŸå¤‡ä»½ã€éªŒè¯æ¢å¤ã€ç¾éš¾æ¼”ç»ƒ</p>
            </div>

            <h3>1. æ•°æ®åº“å®‰å…¨å®æ–½è·¯çº¿å›¾</h3>
            <table class="security-table">
                <thead>
                    <tr>
                        <th>é˜¶æ®µ</th>
                        <th>æ—¶é—´</th>
                        <th>ä¸»è¦ä»»åŠ¡</th>
                        <th>å…³é”®æˆæœ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>è¯„ä¼°é˜¶æ®µ</strong></td>
                        <td>1-2å‘¨</td>
                        <td>ç°çŠ¶è¯„ä¼°ã€é£é™©åˆ†æã€åˆè§„è¦æ±‚</td>
                        <td>å®‰å…¨è¯„ä¼°æŠ¥å‘Šã€é£é™©æ¸…å•</td>
                    </tr>
                    <tr>
                        <td><strong>åŸºç¡€åŠ å›º</strong></td>
                        <td>2-4å‘¨</td>
                        <td>è®¿é—®æ§åˆ¶ã€åŸºç¡€ç›‘æ§ã€å¤‡ä»½é…ç½®</td>
                        <td>æƒé™çŸ©é˜µã€ç›‘æ§åŸºçº¿ã€å¤‡ä»½ç­–ç•¥</td>
                    </tr>
                    <tr>
                        <td><strong>é«˜çº§é˜²æŠ¤</strong></td>
                        <td>4-8å‘¨</td>
                        <td>æ•°æ®åŠ å¯†ã€WAFéƒ¨ç½²ã€å®¡è®¡å¢å¼º</td>
                        <td>åŠ å¯†æ–¹æ¡ˆã€WAFè§„åˆ™ã€å®¡è®¡æŠ¥å‘Š</td>
                    </tr>
                    <tr>
                        <td><strong>è¿ç»´ä¼˜åŒ–</strong></td>
                        <td>æŒç»­è¿›è¡Œ</td>
                        <td>è‡ªåŠ¨åŒ–è¿ç»´ã€æŒç»­ç›‘æ§ã€å®šæœŸè¯„ä¼°</td>
                        <td>è¿ç»´æ‰‹å†Œã€ç›‘æ§ä»ªè¡¨æ¿ã€è¯„ä¼°æŠ¥å‘Š</td>
                    </tr>
                </tbody>
            </table>

            <h3>2. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
            <div class="warning-tip">
                <strong>â“ é—®é¢˜ï¼šæƒé™ç®¡ç†å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤</strong>
                <p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š<br>
                1. å®æ–½åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰<br>
                2. ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ç®¡ç†æƒé™<br>
                3. å®šæœŸå®¡è®¡å’Œæ¸…ç†æ— ç”¨æƒé™<br>
                4. å»ºç«‹æƒé™å˜æ›´å®¡æ‰¹æµç¨‹</p>
            </div>

            <div class="danger-tip">
                <strong>â“ é—®é¢˜ï¼šåŠ å¯†æ€§èƒ½å½±å“ä¸šåŠ¡</strong>
                <p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š<br>
                1. ä½¿ç”¨ç¡¬ä»¶åŠ å¯†åŠ é€Ÿ<br>
                2. å®æ–½åˆ†çº§åŠ å¯†ç­–ç•¥<br>
                3. ä¼˜åŒ–åŠ å¯†ç®—æ³•å’Œå¯†é’¥é•¿åº¦<br>
                4. ä½¿ç”¨é€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰</p>
            </div>

            <div class="info-tip">
                <strong>â“ é—®é¢˜ï¼šåˆè§„è¦æ±‚éš¾ä»¥æ»¡è¶³</strong>
                <p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š<br>
                1. å»ºç«‹åˆè§„æ¡†æ¶å’Œæ§åˆ¶çŸ©é˜µ<br>
                2. ä½¿ç”¨è‡ªåŠ¨åŒ–åˆè§„æ£€æŸ¥å·¥å…·<br>
                3. å®šæœŸè¿›è¡Œåˆè§„å®¡è®¡<br>
                4. ä¿æŒä¸æ³•å¾‹å›¢é˜Ÿçš„æ²Ÿé€š</p>
            </div>

            <h3>3. æ•°æ®åº“å®‰å…¨æ£€æŸ¥æ¸…å•</h3>
            <div class="code-container">
                <button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶æ¸…å•</button>
<pre><code># æ•°æ®åº“å®‰å…¨æ£€æŸ¥æ¸…å•
# å®šæœŸï¼ˆæ¯æœˆ/æ¯å­£åº¦ï¼‰æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥

"""
1. è®¿é—®æ§åˆ¶æ£€æŸ¥
    â–¡ æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·éƒ½æœ‰å¼ºå¯†ç 
    â–¡ æ— é»˜è®¤ç”¨æˆ·æˆ–ç©ºå¯†ç ç”¨æˆ·
    â–¡ æƒé™ç¬¦åˆæœ€å°æƒé™åŸåˆ™
    â–¡ å®šæœŸæ¸…ç†ç¦»èŒå‘˜å·¥æƒé™
    â–¡ æ•æ„Ÿæ“ä½œéœ€è¦å¤šå› ç´ è®¤è¯

2. ç½‘ç»œå®‰å…¨æ£€æŸ¥
    â–¡ æ•°æ®åº“ç«¯å£ä¸å¯¹å¤–ç½‘å¼€æ”¾
    â–¡ é˜²ç«å¢™è§„åˆ™é™åˆ¶è®¿é—®æ¥æº
    â–¡ ä½¿ç”¨SSL/TLSåŠ å¯†è¿æ¥
    â–¡ ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿè¿è¡Œæ­£å¸¸
    â–¡ å®šæœŸæ‰«æç½‘ç»œæ¼æ´

3. æ•°æ®å®‰å…¨æ£€æŸ¥
    â–¡ æ•æ„Ÿæ•°æ®å·²åŠ å¯†å­˜å‚¨
    â–¡ åŠ å¯†å¯†é’¥å®‰å…¨ç®¡ç†
    â–¡ æ•°æ®å¤‡ä»½å®Œæ•´ä¸”å¯æ¢å¤
    â–¡ å¤‡ä»½æ•°æ®åŠ å¯†å­˜å‚¨
    â–¡ æ•°æ®è„±æ•ç­–ç•¥å®æ–½

4. å®¡è®¡ä¸ç›‘æ§æ£€æŸ¥
    â–¡ å®¡è®¡æ—¥å¿—å¼€å¯ä¸”å®Œæ•´
    â–¡ å®šæœŸåˆ†æå®¡è®¡æ—¥å¿—
    â–¡ å®æ—¶ç›‘æ§æ•°æ®åº“æ€§èƒ½
    â–¡ è®¾ç½®å…³é”®æŒ‡æ ‡å‘Šè­¦
    â–¡ å®‰å…¨äº‹ä»¶å“åº”æµç¨‹

5. æ¼æ´ç®¡ç†æ£€æŸ¥
    â–¡ æ•°æ®åº“ç‰ˆæœ¬ä¿æŒæœ€æ–°
    â–¡ å®šæœŸè¿›è¡Œæ¼æ´æ‰«æ
    â–¡ å®‰å…¨è¡¥ä¸åŠæ—¶åº”ç”¨
    â–¡ é…ç½®ç¬¦åˆå®‰å…¨åŸºçº¿
    â–¡ å®šæœŸæ¸—é€æµ‹è¯•

6. å¤‡ä»½æ¢å¤æ£€æŸ¥
    â–¡ å¤‡ä»½ç­–ç•¥ç¬¦åˆ3-2-1åŸåˆ™
    â–¡ å¤‡ä»½æ–‡ä»¶å®šæœŸéªŒè¯
    â–¡ æ¢å¤æ¼”ç»ƒå®šæœŸè¿›è¡Œ
    â–¡ ç¾éš¾æ¢å¤è®¡åˆ’æ›´æ–°
    â–¡ å¤‡ä»½åŠ å¯†å’Œè®¿é—®æ§åˆ¶

7. åˆè§„æ€§æ£€æŸ¥
    â–¡ ç¬¦åˆç›¸å…³æ³•å¾‹æ³•è§„
    â–¡ æ•°æ®ä¿æŠ¤æ”¿ç­–æ‰§è¡Œ
    â–¡ éšç§ä¿æŠ¤æªæ–½åˆ°ä½
    â–¡ ç¬¬ä¸‰æ–¹å®¡è®¡é€šè¿‡
    â–¡ åˆè§„æ–‡æ¡£å®Œæ•´

8. è¿ç»´å®‰å…¨æ£€æŸ¥
    â–¡ è¿ç»´æ“ä½œæœ‰å®¡è®¡è·Ÿè¸ª
    â–¡ å˜æ›´ç®¡ç†æµç¨‹è§„èŒƒ
    â–¡ åº”æ€¥å“åº”è®¡åˆ’å®Œå–„
    â–¡ å®‰å…¨åŸ¹è®­å®šæœŸå¼€å±•
    â–¡ å®‰å…¨æ„è¯†æŒç»­æå‡
"""

# æ£€æŸ¥ç»“æœè¯„åˆ†æ ‡å‡†
SCORING_CRITERIA = {
    "ä¼˜ç§€": "æ‰€æœ‰æ£€æŸ¥é¡¹é€šè¿‡ï¼Œæ— å®‰å…¨é—®é¢˜",
    "è‰¯å¥½": "å°‘é‡ä½é£é™©é—®é¢˜ï¼Œå·²åˆ¶å®šä¿®å¤è®¡åˆ’",
    "ä¸€èˆ¬": "å­˜åœ¨ä¸­é£é™©é—®é¢˜ï¼Œéœ€è¦ä¼˜å…ˆå¤„ç†",
    "å·®": "å­˜åœ¨é«˜é£é™©é—®é¢˜ï¼Œéœ€è¦ç«‹å³å¤„ç†"
}</code></pre>
            </div>

            <h3>4. æœªæ¥å‘å±•è¶‹åŠ¿</h3>
            <div class="security-cards">
                <div class="security-card">
                    <h4><i class="fas fa-robot"></i> AIé©±åŠ¨çš„å®‰å…¨</h4>
                    <p>æœºå™¨å­¦ä¹ å¼‚å¸¸æ£€æµ‹ã€æ™ºèƒ½å¨èƒåˆ†æã€è‡ªåŠ¨åŒ–å“åº”ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-lock"></i> åŒæ€åŠ å¯†</h4>
                    <p>åœ¨åŠ å¯†æ•°æ®ä¸Šç›´æ¥è®¡ç®—ï¼Œä¿æŠ¤æ•°æ®åœ¨å¤„ç†è¿‡ç¨‹ä¸­çš„å®‰å…¨ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-project-diagram"></i> åŒºå—é“¾å®¡è®¡</h4>
                    <p>ä½¿ç”¨åŒºå—é“¾æŠ€æœ¯å®ç°ä¸å¯ç¯¡æ”¹çš„å®¡è®¡æ—¥å¿—ã€‚</p>
                </div>
                <div class="security-card">
                    <h4><i class="fas fa-user-shield"></i> é›¶ä¿¡ä»»æ¶æ„</h4>
                    <p>ä¸ä¿¡ä»»ä»»ä½•å†…éƒ¨æˆ–å¤–éƒ¨å®ä½“ï¼ŒæŒç»­éªŒè¯è®¿é—®æƒé™ã€‚</p>
                </div>
            </div>

            <div class="warning-tip" style="margin-top: 30px;">
                <strong>ğŸ¯ æœ€åå»ºè®®ï¼š</strong>
                <p>1. <strong>ä»åŸºç¡€å¼€å§‹</strong>ï¼šå…ˆè§£å†³é«˜é£é™©é—®é¢˜ï¼Œå†é€æ­¥å®Œå–„<br>
                2. <strong>æŒç»­æ”¹è¿›</strong>ï¼šå®‰å…¨æ˜¯æŒç»­è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§é¡¹ç›®<br>
                3. <strong>å…¨å‘˜å‚ä¸</strong>ï¼šå®‰å…¨ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œéœ€è¦å…¨å‘˜å®‰å…¨æ„è¯†<br>
                4. <strong>ä¿æŒå­¦ä¹ </strong>ï¼šå®‰å…¨å¨èƒä¸æ–­æ¼”å˜ï¼Œéœ€è¦æŒç»­å­¦ä¹ æ–°çŸ¥è¯†<br>
                5. <strong>å®šæœŸæ¼”ç»ƒ</strong>ï¼šå®šæœŸè¿›è¡Œå®‰å…¨æ¼”ç»ƒå’Œæ¢å¤æµ‹è¯•ï¼Œç¡®ä¿é¢„æ¡ˆæœ‰æ•ˆ</p>
            </div>
        </section>

        <!-- æ–‡ç« ç»“æŸè¯­ -->
        <div style="text-align: center; margin: 50px 0 30px; padding: 30px; border-radius: 12px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));">
            <h3 style="color: #10b981; margin-bottom: 15px;">ğŸ”’ ä¿æŠ¤æ•°æ®å°±æ˜¯ä¿æŠ¤ä¸šåŠ¡æ ¸å¿ƒï¼</h3>
            <p style="margin-bottom: 20px;">æ•°æ®åº“å®‰å…¨æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦ä»æŠ€æœ¯ã€ç®¡ç†å’Œæµç¨‹å¤šä¸ªå±‚é¢ç»¼åˆè€ƒè™‘ã€‚é€šè¿‡æŒç»­çš„å®‰å…¨åŠ å›ºå’Œè¿ç»´ç®¡ç†ï¼Œå¯ä»¥æ„å»ºåšå›ºçš„æ•°æ®å®‰å…¨é˜²çº¿ï¼Œä¿éšœä¼ä¸šä¸šåŠ¡çš„ç¨³å®šè¿è¡Œã€‚</p>
            <p style="font-size: 14px; color: #94a3b8;">å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼</p>
        </div>

        <!-- æ–‡ç« ä¿¡æ¯ -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #334155;">
            <div>
                <span style="font-size: 14px; color: #94a3b8;">æ ‡ç­¾ï¼š</span>
                <span style="background: #1e293b; color: #cbd5e1; padding: 4px 12px; border-radius: 20px; font-size: 13px; margin-right: 8px;">æ•°æ®åº“å®‰å…¨</span>
                <span style="background: #1e293b; color: #cbd5e1; padding: 4px 12px; border-radius: 20px; font-size: 13px; margin-right: 8px;">SQLæ³¨å…¥é˜²æŠ¤</span>
                <span style="background: #1e293b; color: #cbd5e1; padding: 4px 12px; border-radius: 20px; font-size: 13px; margin-right: 8px;">æ•°æ®åŠ å¯†</span>
                <span style="background: #1e293b; color: #cbd5e1; padding: 4px 12px; border-radius: 20px; font-size: 13px;">å¤‡ä»½æ¢å¤</span>
            </div>
            <div style="font-size: 14px; color: #94a3b8;">
                <span>æœ€åæ›´æ–°ï¼š2025-12-10</span>
            </div>
        </div>
    </main>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
    <div class="back-to-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // ä¸»é¢˜åˆ‡æ¢
        function toggleTheme() {
            const body = document.body;
            if (body.classList.contains('light')) {
                body.classList.remove('light');
                body.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark');
                body.classList.add('light');
                localStorage.setItem('theme', 'light');
            }
        }

        // é¡µé¢åŠ è½½æ—¶åº”ç”¨ä¿å­˜çš„ä¸»é¢˜
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.classList.remove('light', 'dark');
            document.body.classList.add(savedTheme);
            
            // åˆå§‹åŒ–ä»£ç å¤åˆ¶åŠŸèƒ½
            initCopyButtons();
        });

        // å¤åˆ¶ä»£ç åŠŸèƒ½
        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const codeText = codeBlock.textContent;
            
            navigator.clipboard.writeText(codeText).then(() => {
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
                button.classList.add('copied');
                button.textContent = 'å·²å¤åˆ¶ï¼';
                
                setTimeout(() => {
                    button.classList.remove('copied');
                    button.textContent = button.textContent.includes('SQL') ? 'å¤åˆ¶SQL' : 
                                      button.textContent.includes('è„šæœ¬') ? 'å¤åˆ¶è„šæœ¬' : 
                                      button.textContent.includes('é…ç½®') ? 'å¤åˆ¶é…ç½®' : 
                                      button.textContent.includes('æ¸…å•') ? 'å¤åˆ¶æ¸…å•' : 'å¤åˆ¶ä»£ç ';
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                button.textContent = 'å¤åˆ¶å¤±è´¥';
                setTimeout(() => {
                    button.textContent = 'å¤åˆ¶ä»£ç ';
                }, 2000);
            });
        }

        // åˆå§‹åŒ–æ‰€æœ‰å¤åˆ¶æŒ‰é’®
        function initCopyButtons() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(button => {
                button.addEventListener('click', () => copyCode(button));
            });
        }

        // å›åˆ°é¡¶éƒ¨åŠŸèƒ½
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // æ˜¾ç¤º/éšè—å›åˆ°é¡¶éƒ¨æŒ‰é’®
        window.addEventListener('scroll', () => {
            const backToTopBtn = document.querySelector('.back-to-top');
            if (window.scrollY > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        // ç›®å½•ç‚¹å‡»å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('.toc a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    const offset = 100; // å¯¼èˆªæ é«˜åº¦åç§»
                    const targetPosition = targetElement.offsetTop - offset;
                    
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                    
                    // æ›´æ–°URLå“ˆå¸Œï¼ˆå¯é€‰ï¼‰
                    history.pushState(null, null, `#${targetId}`);
                }
            });
        });

        // ç›‘å¬æ»šåŠ¨ï¼Œé«˜äº®å½“å‰æŸ¥çœ‹çš„ç« èŠ‚
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.content-section');
            const navLinks = document.querySelectorAll('.toc a');
            
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 150;
                const sectionHeight = section.clientHeight;
                
                if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${currentSection}`) {
                    link.classList.add('active');
                }
            });
        });

        // ä»£ç å—è¯­æ³•é«˜äº®ï¼ˆç®€å•å®ç°ï¼‰
        function highlightCode() {
            const codeBlocks = document.querySelectorAll('pre code');
            codeBlocks.forEach(block => {
                // ç®€å•çš„å…³é”®å­—é«˜äº®
                const code = block.textContent;
                const highlighted = code
                    .replace(/\b(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP|GRANT|REVOKE|FROM|WHERE|AND|OR|JOIN|INTO|VALUES|SET|TABLE|DATABASE|INDEX|VIEW|PROCEDURE|FUNCTION|TRIGGER|EVENT)\b/gi, '<span class="keyword">$1</span>')
                    .replace(/\b(NULL|TRUE|FALSE|NOT)\b/gi, '<span class="constant">$1</span>')
                    .replace(/("[^"]*"|'[^']*')/g, '<span class="string">$1</span>')
                    .replace(/(--.*$|\/\*[\s\S]*?\*\/)/gm, '<span class="comment">$1</span>');
                
                block.innerHTML = highlighted;
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œä»£ç é«˜äº®
        window.addEventListener('load', highlightCode);
    </script>
</body>
</html>
